webpackJsonp([10],Array(158).concat([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(96),s=function(){function e(t){r(this,e),this.view=t,this.roadBeadPlate=t.getChildAt(0).asCom,this.cols=this._orgCols=Math.max(9,Math.ceil(this.view.width/27)),this.roadBeadPlate.getChild("n90").asList.removeChildren()}return o(e,[{key:"refreshRoad",value:function(e){var t=this.roadBeadPlate.getChild("n90").asList;t.removeChildren();var n=Math.floor(e.length/6)+1,r=Math.max(n,this._orgCols);this.cols=r,n>=this._orgCols?this.view.scrollPane.setPosX(this.roadBeadPlate.width-this.view.width):this.view.scrollPane.setPosX(0);for(var i=t._children.length;i<e.length;i++){var o=fairygui.UIPackage.createObject("Package1","路格1"),a=e[i],s=o.getController("c1");if(s.selectedIndex=0,!a)return;"banker"==a.win?s.selectedIndex=1:"player"==a.win?s.selectedIndex=2:s.selectedIndex=3,a.demo?o.getTransition("t0").play():o.getTransition("t0").stop(),o.getChild("n6").visible=a.bankerPair,o.getChild("n7").visible=a.playerPair,t.addChild(o)}}},{key:"cols",get:function(){return this._cols},set:function(e){this._cols=e,this.roadBeadPlate.width=28*this._cols+1}}]),e}(),c=function(){function e(t){r(this,e),this.view=t,this.roadBig=t.getChildAt(0).asCom,this.cols=this._orgCols=Math.max(24,Math.ceil(this.view.width/13))}return o(e,[{key:"bigRoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.columns,t.rows),r=void 0===n?6:n,i=[],o={},s=0,c=void 0,u=[],d=0;return e.forEach(function(e){if("tie"===e.win)i.push(e);else{if(c){var t=a.last(u);"tie"===c.win&&t&&(t.ties=a.cloneDeep(i),i=[],c=t.result),t&&c.win&&c.win!==e.win&&s++}for(var n=s,l=0,f=!1;!f;){var p=n+"."+l,h=n+"."+(l+1);if(a.get(o,p))l+1>=r?n++:a.get(o,h)?a.get(o,h).result.win===e.win?l++:n++:l++;else{var g=a.merge({},{row:l,column:n,logicalColumn:s,ties:a.cloneDeep(i)},{result:e});a.set(o,p,g),u.push(o[n][l]),f=!0}}i=[],d=Math.max(d,n)}c=e}),a.isEmpty(u)&&i.length>0?u.push({ties:a.cloneDeep(i),column:0,row:0,logicalColumn:0,result:{}}):!a.isEmpty(u)&&i.length&&(a.last(u).ties=a.cloneDeep(i)),u.maximumColumnReached=d,u}},{key:"logicalRoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.columns,t.rows,[]),r=0,i=void 0;return e.forEach(function(e){"tie"!==e.win&&(i&&i.win&&i.win!==e.win&&r++,n[r]?n[r].push({result:e}):n[r]=[{result:e}],i=e)}),n}},{key:"refreshRoad",value:function(e){var t=this.roadBig,n=this.bigRoad(e),r=Math.max(n.maximumColumnReached,this._orgCols);this.cols=2*Math.floor(r/2)+2,n.maximumColumnReached>=this._orgCols?this.view.scrollPane.setPosX(this.roadBig.width-this.view.width):this.view.scrollPane.setPosX(0),t.removeChildren(2);for(var i=0;i<n.length;i++){var o=fairygui.UIPackage.createObject("Package1","路格2"),a=n[i].result,s=o.getController("c1");null==a.win?s.selectedIndex=0:"banker"==a.win?s.selectedIndex=1:"player"==a.win&&(s.selectedIndex=2),a.demo?o.getTransition("t0").play():o.getTransition("t0").stop(),o.getChild("n68").visible=a.bankerPair,o.getChild("n69").visible=a.playerPair,o.getChild("n72").visible=null!=n[i].ties&&n[i].ties.length>0,o.x=14*n[i].column+2,o.y=14*n[i].row+2,t.addChild(o)}}},{key:"cols",get:function(){return this._cols},set:function(e){this._cols=e,this.roadBig.width=14*this._cols+1}}]),e}(),u=function(){function e(t,n,i){r(this,e),this.view=t,this.road=t.getChildAt(0).asCom,this.circle=n||1,this.cols=this._orgCols=i||Math.max(24,Math.ceil(this.view.width/7))}return o(e,[{key:"makeResult",value:function(e,t){return e<=t?"red":e==t+1?"blue":"red"}},{key:"reverseResult",value:function(e){return"red"==e?"blue":"red"}},{key:"bigEye",value:function(e,t){for(var n=[],r=this.circle;r<e.length;r++){var i=e[r],o=r-this.circle,a=e[o].length-1,s=o-1;if(s>=0){var c=e[s].length-1,u=a+1;n.push(this.reverseResult(this.makeResult(u,c)))}for(var d=1;d<i.length;d++)n.push(this.makeResult(d,a))}return n[n.length-1]={color:n[n.length-1],isDemo:t},this.turn2Map(n)}},{key:"turn2Map",value:function(e){var t=6,n={},r=0,o=void 0,s=[],c=0;return e.forEach(function(e){var u;"object"==("undefined"==typeof e?"undefined":i(e))&&(u=e.isDemo,e=e.color),o&&o!=e&&r++;for(var d=r,l=0,f=!1;!f;){var p=d+"."+l,h=d+"."+(l+1);if(a.get(n,p))l+1>=t?d++:a.get(n,h)?a.get(n,h).result===e?l++:d++:l++;else{var g=a.merge({},{row:l,column:d,logicalColumn:r},{result:e,isDemo:u});a.set(n,p,g),s.push(n[d][l]),f=!0}}o=e,c=Math.max(c,d)}),s.maximumColumnReached=c,s}},{key:"refreshRoad",value:function(e,t){var n=this.road,r=this.bigEye(e,t),i=Math.max(r.maximumColumnReached,this._orgCols);this.cols=2*Math.round(i/2+1),r.maximumColumnReached>=this._orgCols?this.view.scrollPane.setPosX(n.width-this.view.width):this.view.scrollPane.setPosX(0),n.removeChildren(2);for(var o=0;o<r.length;o++){var a=fairygui.UIPackage.createObject("Package1","路格"+(2+this.circle)),s=r[o].result,c=r[o].isDemo,u=a.getController("c1");"red"==s?u.selectedIndex=0:u.selectedIndex=1,c?a.getTransition("t0").play():a.getTransition("t0").stop(),a.x=7*r[o].column+1,a.y=7*r[o].row+1,n.addChild(a)}}},{key:"cols",get:function(){return this._cols},set:function(e){this._cols=e,this.road.width=7*this._cols+1}}]),e}();e.exports={BeadPlate:s,BigRoad:c,BigEye:u}},,,,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){if("function"==typeof t&&(n=t,t=1e3),t||(t=1e3),n||(n=function(){}),Laya.SoundManager.soundMuted)return setTimeout(function(){console.log(e,"timeout"),n()},t);console.log(e,"last",t);var r=n;n=N(function(t){t?(console.log(e,t),i&&i.stop()):(console.log(e,"done"),clearTimeout(o)),r()});var i=Laya.SoundManager.playSound(e,1,g.create(null,n)),o=setTimeout(function(){n("timeout")},2*t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(163),d=n(18),l=n(10),f=n(96),p=n(210),h=laya.net.Loader,g=laya.utils.Handler,m=window.turf=n(211),v=n(212),y=n(95),w=n(158),b=w.BeadPlate,C=w.BigRoad,E=w.BigEye,k=n(20),R=n(15),S={xian:1,zhuang:.95,xianDui:11,zhuangDui:11,he:8},P=[1,5,10,50,100,500,1e3,5e3,1e4,5e4],x={xianDui:"n200",he:"n201",zhuangDui:"n202",xian:"n203",zhuang:"n204"},T=m.polygon([[[84,555],[238,555],[237,637],[165,634],[128,615],[101,589],[84,555]]]),_=m.polygon([[[274,555],[436,555],[422,584],[402,609],[367,630],[274,637],[274,555]]]),D=m.polygon([[[70,484],[170,484],[170,517],[70,517],[70,484]]]),O=m.polygon([[[204,484],[304,484],[304,517],[204,517],[204,484]]]),A=m.polygon([[[339,484],[439,484],[439,517],[339,517],[339,484]]]),L=function(e){for(var t=0,n=0;n<e.length;n++){var r=e[n];t+="ace"===r.description.toLowerCase()?1:r.sort>=10?0:r.sort}return t%10},I=n(19),N=(I.shortenCoinStr,I.fstr,n(219)),M=function(e){function t(e){function o(e,t){var n=c._view.getChild("n2"),r=c.gamedata.his.slice(0,c.gamedata.setnum);if(!t){var i=r[r.length-1];i&&delete i.demo}if(n.getChild("n57").text=r.length,c.roadBeadPlate&&c.roadBeadPlate.refreshRoad(r),c.bigRoad){c.bigRoad.refreshRoad(r,t);var o=c.bigRoad.logicalRoad(r);c.bigEye&&c.bigEye.refreshRoad(o,t),c.smallRoad.refreshRoad(o,t),c.cockroachRoad.refreshRoad(o,t)}for(var a=0,s=0,u=0,d=0,l=0,f=0,p=0;p<r.length;p++)"banker"==r[p].win?a++:"player"==r[p].win?s++:u++,r[p].bankerPair&&d++,r[p].playerPair&&l++,r[p].playerTian&&f++,r[p].bankerTian&&f++;n.getChild("n45").text=a,n.getChild("n47").text=s,n.getChild("n49").text=u,n.getChild("n51").text=d,n.getChild("n53").text=l,n.getChild("n55").text=f}r(this,t),e.disableRtc=!0;var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));s._coins={},s._lastDeal={},s._first_status_chgd=!0;var c=s,u=s.gamedata;return s.gamedata.on("inited",function(){c.roadBeadPlate=new b(c._view.getChild("n2").getChild("n17").getChild("n1")),c.bigRoad=new C(c._view.getChild("n2").getChild("n19").getChild("n19")),c.bigEye=new E(c._view.getChild("n2").getChild("n20").getChild("n20")),c.smallRoad=new E(c._view.getChild("n2").getChild("n22").getChild("n23"),2),c.cockroachRoad=new E(c._view.getChild("n2").getChild("n23").getChild("n23"),3);for(var e=c._view.getChild("n35").scrollPane,t=0;t<P.length&&!(P[t]>u.opt.minZhu);t++);t--,t>=P.length-5&&(t=P.length-5),t<0&&(t=0),e.setPosX(80*t+5)}).on("statuschgd",function(){if(!c._first_status_chgd||(c._first_status_chgd=!1,3!=u.status))switch(console.log("chg status to",u.status),1==u.status&&a(n(221)),c._view.getController("fapai").selectedIndex=u.status,c._view.getChild("n79").visible=!1,u.status){case 1:c._view.getChild("n53").visible=!0,c._view.getChild("n41").visible=!0,["n20","n22","n21","n19","n400","n401","n402","n403","n404"].forEach(function(e){c._view.getChild(e).enabled=!0}),c._lastDeal={};break;case 2:}}).on("countdownchgd",function(){u.countdown>0&&u.countdown<=5&&a(n(222)),c._view.getChild("n53").text=u.countdown,u.countdown<=5&&c._view.getTransition("t14").play(),0==u.countdown&&c._view.getTransition("t1").play(),u.countdown<=0&&(c._view.getChild("n41").visible=c._view.getChild("n53").visible=!1)}).on("roomidchgd",function(){c._view.getChild("n6").text="房间号："+c.gamedata.roomid}).on("onlinechgd",function(){c._view.getChild("n182").getChild("n2").text=c.gamedata.online}).on("game.leftCardschgd",function(){c._view.getChild("n46").text=c.gamedata.game.leftCards}).on("optchgd",function(){var e=c._view.getChild("n2"),t=c.gamedata.opt;e.getChild("n35").text=t.minZhu+"-"+t.maxZhu,e.getChild("n68").text=t.minDui||1,e.getChild("n70").text=(t.maxHe||750)+"/"+(t.maxDui||950)}).on("setnumchgd",o).on("hischgd",o).on("game.player.cardschgd",function(){2==u.status&&c.pausemsg(function(e){c._view.getChild("n28").url=c._view.getChild("n66").url=p(u.game.player.cards[0]),c._view.getChild("n67").url=c._view.getChild("n30").url=p(u.game.player.cards[1]),c._view.getChild("n33").url=c._view.getChild("n68").url=null,c._view.getChild("n31").url=c._view.getChild("n71").url=p(u.game.banker.cards[0]),c._view.getChild("n32").url=c._view.getChild("n72").url=p(u.game.banker.cards[1]),c._view.getChild("n34").url=c._view.getChild("n73").url=null,c._view.getChild("n47").text=c._view.getChild("n70").text=L(u.game.player.cards.slice(0,2)),c._view.getChild("n48").text=c._view.getChild("n75").text=L(u.game.banker.cards.slice(0,2)),c._view.getController("c1").selectedIndex=0,["n400","n401","n402","n403","n404"].forEach(function(e){c._view.getChild(e).enabled=!1});var t=[function(e){function t(e){return e()}function n(e){setTimeout(e,2500)}c._view.getTransition("t2").play(),n(t.bind(null,e))},function(e){return u.game.player.cards.length<3?e():void R.parallel([function(e){return e()},function(e){a(n(251)),c._view.getChild("n68").url=c._view.getChild("n33").url=p(u.game.player.cards[2]),c._view.getTransition("t3").play(g.create(null,function(){c._view.getChild("n47").text=c._view.getChild("n70").text=L(u.game.player.cards),e()}))}],function(){return e()})},function(e){return u.game.banker.cards.length<3?e():void R.parallel([function(e){return e()},function(e){a(n(251)),c._view.getChild("n34").url=c._view.getChild("n73").url=p(u.game.banker.cards[2]),c._view.getTransition("t4").play(g.create(null,function(){c._view.getChild("n48").text=c._view.getChild("n75").text=L(u.game.banker.cards),e()}))}],function(){return e()})},function(e){a(n(223)("./play"+L(u.game.player.cards)+".mp3"),1200,function(){a(n(237)("./bank"+L(u.game.banker.cards)+".mp3"),1200,e)})},function(e){var t=L(u.game.banker.cards),r=L(u.game.player.cards),i=c._view.getChild("n79");t>r?(i.url=fairygui.UIPackage.getItemURL("Package1","庄赢"),a(n(250))):t==r?(i.url=fairygui.UIPackage.getItemURL("Package1","平局"),a(n(252))):(i.url=fairygui.UIPackage.getItemURL("Package1","闲赢"),a(n(236))),c._view.getTransition("t6").play(g.create(null,e))},function(e){var t=u.his[u.his.length-1];"player"==t.win?c._view.getTransition("t10").play():"banker"==t.win?c._view.getTransition("t11").play():c._view.getTransition("t8").play(),t.playerPair&&c._view.getTransition("t7").play(),t.bankerPair&&c._view.getTransition("t9").play(),setTimeout(e,700)},function(e){var t=u.his[u.his.length-1],r=[],i=[],o=[];"tie"==t.win?(i.push("he"),c._view.getTransition("t8").play(),o=["zhuang","xian"]):("banker"==t.win&&(c._view.getTransition("t11").play(),i.push("zhuang")),"player"==t.win&&(c._view.getTransition("t10").play(),i.push("xian")),t.playerPair&&(r.push(n(235)),i.push("xianDui"),c._view.getTransition("t7").play()),t.bankerPair&&(r.push(n(249)),i.push("zhuangDui"),c._view.getTransition("t9").play())),R.parallel([function(e){R.eachLimit(r,1,function(e,t){a(e,1300,t)},function(){e()})},function(e){setTimeout(e,300)}],function(){var t=i.concat(o);t.unshift(["zhuang","xian","he","xianDui","zhuangDui"]);var n=f.without.apply(f,t);e(null,i,n,o)})},function(e,t,r,i){var o=0;t.forEach(function(e){var t=function(t){for(var n=c._coins[t][e],r=function(e){o++,c.flyCoin(n[e],{x:267,y:383},0,function(){c._view.removeChild(n[e]),n[e]=null})},i=0;i<n.length;i++)r(i)};for(var n in c._coins)t(n)}),o>1?a(n(253)):1==o&&a(n(254)),setTimeout(i,500,null,e,t,r)},function(e,t,n,r){for(var i=0;i<t.length;i++){var o=c._view.getChild(x[t[i]]);o&&(o.visible=!1)}r(null,e,t,n)},function(e,t,r,i){var o=0;for(var s in c._coins){for(var d={},l=0;l<e.length;l++)d[e[l]]=u.deal[s][e[l]]*S[e[l]];for(var f=c.calcCoinsDst(d),p=c._coins[s],h=70,l=0;l<f.length;l++)p[f[l].t].push(c.makeCoin({x:267,y:383},f[l].p,f[l].c,70*l)),h+=70,h>500&&(h=500);h>o&&(o=h)}o>70?a(n(253)):70==o&&a(n(254)),setTimeout(i,o+450,null,e,t,r)},function(e,t,n,r){for(var i=e.concat(n),o=0;o<i.length;o++){var a=c._view.getChild(x[i[o]]);a&&(a.visible=!1)}r(null,e,t,n)},function(e,t,r,i){var o=0;e.concat(r).forEach(function(e){var t=function(t){var n=c._coins[t][e];r=t==me.id?{x:469,y:318}:{x:44,y:414};for(var i=function(e){o++,c.flyCoin(n[e],r,0,function(){c._view.removeChild(n[e]),n[e]=null})},a=0;a<n.length;a++)i(a)};for(var n in c._coins){var r;t(n)}}),o>1?a(n(253)):1==o&&a(n(254)),setTimeout(i,500)},function(e){c.clearAllCoins(),e()},function(e){c._view.getTransition("t5").play(g.create(null,e))},function(e){c._view.getChild("n35").getChildAt(0).getController("c1").selectedIndex=0,e()}];R.waterfall(t,e)})}).on("/deal\\.([^\\.]+)chgd/",function(e,t){if(1==u.status){for(var r=t.split(/(\\u[A-Fa-f0-9]{4})/g),i=0;i<r.length;i++)"\\"==r[i][0]&&(r[i]=String.fromCharCode(parseInt(r[i].substr(2),16)));t=r.join("");var o=l(u.deal[t]),s=0,d=c._lastDeal[t];if(t==me.id&&c._handleCoinschgd(),["xian","zhuang","he","xianDui","zhuangDui"].forEach(function(e){s+=o[e]}),d&&["xian","zhuang","he","xianDui","zhuangDui"].forEach(function(e){null!=o[e]&&null!=d[e]&&(o[e]-=d[e])}),["xian","zhuang","he","xianDui","zhuangDui"].forEach(function(e){if(o[e]){var t=(o[e]>0,0);for(var n in u.deal)t+=u.deal[n][e];var r=c._view.getChild(x[e]);r&&(t?(r.visible=!0,r.getChild("n121").text=""+t):r.visible=!1)}}),s>0){c._lastDeal[t]=l(u.deal[t]);var f=c.calcCoinsDst(o);a(1==f.length?n(254):n(253)),c._coins[t]||(c._coins[t]={xian:[],zhuang:[],xianDui:[],zhuangDui:[],he:[]});var p=c._coins[t];if(t==me.id){c._myLastXiazhu=l(u.deal[t]);for(var i=0;i<f.length;i++)p[f[i].t].push(c.makeCoin({x:257,y:801},f[i].p,f[i].c,70*i))}else for(var i=0;i<f.length;i++)p[f[i].t].push(c.makeCoin({x:44,y:414},f[i].p,f[i].c,70*i))}else{c._lastDeal[t]=l(u.deal[t]);var h=t==me.id?{x:257,y:801}:{x:44,y:414};a(n(255));var g=function(e){for(var n=c._coins[t][e],r=function(e){n[e]&&c.flyCoin(n[e],h,0,function(){c._view.removeChild(n[e])})},i=0;i<n.length;i++)r(i);c._coins[t][e]=[]};for(var m in c._coins[t])g(m)}}}),s}return o(t,e),s(t,[{key:"clearAllCoins",value:function(){var e=this;for(var t in e._coins)for(var n in e._coins[t])for(var r=e._coins[t][n],i=0;i<r.length;i++)r[i]&&this._view.removeChild(r[i]);e._coins={}}},{key:"makeCoin",value:function(e,t,n,r){var i=fairygui.UIPackage.createObject("Package1",""+n+"小");if(!i)return null;i.x=e.x,i.y=e.y,i.__value=n;var o=this._view.getChild("n119");return this._view.addChildAt(i,this._view.getChildIndex(o)),Laya.Tween.to(i,t,300,Laya.Ease.quadOut,null,r),i}},{key:"flyCoin",value:function(e,t,n,r){Laya.Tween.to(e,t,500,Laya.Ease.quadOut,r?g.create(null,r):null,n)}},{key:"analyzeCoin",value:function(e){for(var t=[],n=0,r=P.length-1;r>=0;r--){var i=P[r];if(e>r){var o=Math.floor(e/i);o&&(t.push({c:i,n:o}),n+=o),e%=i}}return t.total_n=n,t}},{key:"calcCoinsDst",value:function(e){function t(e,t,n){for(var r=v(e.total_n,t),i=0,o=[],a=0;a<e.length;a++)for(var s=0;s<e[a].n;s++){var c=r[i].geometry.coordinates;o.push({c:e[a].c,p:{x:c[0],y:c[1]},t:n}),i++}return o}var n=[];return e.xian&&(n=t(this.analyzeCoin(e.xian),T,"xian")),e.zhuang&&(n=n.concat(t(this.analyzeCoin(e.zhuang),_,"zhuang"))),e.he&&(n=n.concat(t(this.analyzeCoin(e.he),O,"he"))),e.xianDui&&(n=n.concat(t(this.analyzeCoin(e.xianDui),D,"xianDui"))),e.zhuangDui&&(n=n.concat(t(this.analyzeCoin(e.zhuangDui),A,"zhuangDui"))),n}},{key:"renderBeadPlate",value:function(e,t){if(this.gamedata&&this.gamedata.his){var n=this.gamedata.his[e],r=t.getController("c1");r.selectedIndex=0,n&&("banker"==n.win?r.selectedIndex=0:"player"==n.win?r.selectedIndex=1:r.selectedIndex=2,t.getChild("n6").visible=n.bankerPair,t.getChild("n7").visible=n.playerPair)}}},{key:"getUserMediaRect",value:function(e){return null}},{key:"getVoiceBtn",value:function(){return null}},{key:"onVideoActived",value:function(){}},{key:"active",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"active",this).call(this),Laya.SoundManager.playMusic(n(256)),this._coins={},this._lastDeal={},this._first_status_chgd=!0,this._myLastXiazhu={},this._view.getChild("n28").url=null,this._view.getChild("n30").url=null,this._view.getChild("n33").url=null,this._view.getChild("n31").url=null,this._view.getChild("n32").url=null,this._view.getChild("n34").url=null;var e=this;["n200","n201","n202","n203","n204","n41","n53","n56","n57","n58","n59","n60"].forEach(function(t){e._view.getChild(t).visible=!1}),this._view.x=0;var e=this;this._handleCoinschgd=function(){e._view.getChild("n85").text=me.coins||0},me.on("coinschgd",this._handleCoinschgd)}},{key:"deactive",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deactive",this).call(this),this.clearAllCoins(),me.removeListener("coinschgd",this._handleCoinschgd)}},{key:"msg",value:function(e){switch(c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"msg",this).call(this,e),e.c){case"table.cardcomplete":tipon("牌用完了，换新牌").popup();break;case"table.chat":var n=e,r=k("【%s】  %s",n.nickname||n.role,n.str);tipon(r,{waitHandler:function(){}}).popup()}return!0}}],[{key:"create",value:function(e,r){e=d(e,{seatNumber:4}),Laya.loader.load([{url:n(149),type:h.IMAGE},{url:n(150),type:h.IMAGE},{url:n(151),type:h.BUFFER}],g.create(null,function(){var n=new t(e);fairygui.UIPackage.addPackage("baccarat");var i=n._view=fairygui.UIPackage.createObject("Package1","游戏界面").asCom;i.getChild("n5").onClick(null,function(){_socket.sendp({c:"quitgame"})});var o=i.getChild("n2");o.getChild("n71").onClick(null,function(){var e=n.gamedata.his[n.gamedata.his.length-1];e&&e.demo?e.win="banker":n.gamedata.his.push({win:"banker",demo:!0}),n.gamedata.emit("hischgd",n.gamedata.his,!0)}),o.getChild("n72").onClick(null,function(){var e=n.gamedata.his[n.gamedata.his.length-1];e&&e.demo?e.win="player":n.gamedata.his.push({win:"player",demo:!0}),n.gamedata.emit("hischgd",n.gamedata.his,!0)}),o.getChild("n84").onClick(null,function(){n.gamedata.his.push({win:"tie"}),n.gamedata.emit("hischgd",n.gamedata)}),i.getChild("n35").scrollItemToViewOnClick=!1;for(var a=i.getChild("n35").getChildAt(0),s=(a.getChildAt(0),i.getController("c1"),i.getChild("n35").getChildAt(0).getController("c1")),c=[null,"xianDui","he","zhuangDui","xian","zhuang"],u=function(e){var t=i.getChild("n"+e);return!t instanceof fairygui.GButton?"continue":void t.onClick(null,function(){if(s.selectedIndex){var t={c:"table.xiazhu"};t[c[e-399]]=P[s.selectedIndex-1],_socket.sendp(t)}})},l=400;l<405;l++){u(l)}i.getChild("n19").onClick(null,function(){_socket.sendp(d({c:"table.xiazhu"},n._myLastXiazhu))}),i.getChild("n22").onClick(null,function(){var e=n.gamedata.deal[me.id];e&&(e.xian||e.zhuang||e.xianDui||e.zhuangDui||e.he)&&(_socket.sendp({c:"table.confirmXiazhu"}),["n20","n22","n21","n19"].forEach(function(e){i.getChild(e).enabled=!1}))}),i.getChild("n20").onClick(null,function(){_socket.sendp({c:"table.cancelXiazhu"})}),i.getChild("n21").onClick(null,function(){_socket.sendp(d({c:"table.xiazhu"},n.gamedata.deal[me.id]))});var f=i.getChild("n35").scrollPane;i.getChild("n24").onClick(null,function(){f.setPosX(f.posX-80,!0)}),i.getChild("n25").onClick(null,function(){f.setPosX(f.posX+80,!0)}),i.getChild("n182").onClick(null,function(){var e=new y.RestPlayersWin(n.gamedata);e.show()}),n.afterCreateView(),r(null,n)}))}}]),t}(u);e.exports=M.create},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function s(e,t,n){if(null!=e&&"object"==("undefined"==typeof e?"undefined":u(e)))for(var r in e){var i=r.replace(/\\/g,"\\u005c").replace(/\./g,"\\u002e"),o=t?t+"."+i:i;n(o,e[r]),s(e[r],o,n)}}function c(e,t){"function"==typeof e&&(t=e,e=null),e=e||"com.1357g.h5.niuniu",t=t||w,y.connect(e,function(n){console.log("easyrtc connected",e,n),t(null,n)},function(e){t(e)})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(164),f=n(18),p=n(25),h=n(76),g=n(95),m=function(){function e(){o(this,e)}return d(e,[{key:"assignAllBtns",value:function(){for(var e=this,t=this._view._children,n=/[A-Za-z]\d+/,r=0;r<t.length;r++){var i=t[r].asButton;if(i instanceof fairygui.GButton){var o=function(){if(n.test(i.name))return"continue";var t=i.name.split("."),r=t[1]||1;t=t[0];var o=e._view.getController(t);o?(i.onClick(e,function(){o.selectedIndex=r}),o.setSelectedIndex(0)):i.onClick(e,function(){var e=a(t)+"Win";if(g[e])var n=new g[e];else var n=new g.Win(t);n.modal=!0,n.show()})}();if("continue"===o)continue}}}},{key:"active",value:function(){console.log("你可以自行实现.active函数")}},{key:"deactive",value:function(){console.log("你可以自行实现.deactive函数")}},{key:"msg",value:function(e){console.log("你可以自行实现.msg函数,这里可以处理服务器来的消息")}}],[{key:"create",value:function(e,t){l.fail("必须自己实现create")}}]),e}(),v=function(e){function t(){o(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=e._rangeEvents=[];return e.on("newListener",function(e,t){0==e.indexOf("/")&&n.push({reg:new RegExp(e.substring(1,e.length-1)),k:e})}),e.on("removeListener",function(e,t){var r=n.findIndex(function(t){return t.k==e});r>=0&&n.splice(r,1)}),e}return i(t,e),d(t,[{key:"_enumAttr",value:function(e,t,n){if(null!=e&&"object"==("undefined"==typeof e?"undefined":u(e)))for(var r in e)if("$"!=r&&!(r.indexOf("_")>=0)){var i=r.replace(/\\/g,"\\u005c").replace(/\./g,"\\u002e"),o=t?t+"."+i:i;n(o,e[r]),"object"==u(e[r])&&this._enumAttr(e[r],o,n)}}},{key:"_chkRegEvent",value:function(e){for(var t=0;t<this._rangeEvents.length;t++){var n=this._rangeEvents[t].reg.exec(e);n&&(n.unshift(this._rangeEvents[t].k),this.emit.apply(this,n))}}},{key:"_update",value:function(e){var t=Object.keys(e);2==t.length&&null!=e.countdown||console.log(e);var n=this;if(e.$){if(e.$.init){for(var r in this)"function"!=typeof this[r]&&0!=r.indexOf("_")&&delete this[r];return f.recursive(this,e),this.emit("inited",this),void s(this,null,function(e,t){"function"!=typeof t&&0!=e.indexOf("_")&&(console.log(""+e+"chgd"),n.emit(""+e+"chgd",n),n._chkRegEvent(""+e+"chgd"))})}if(e.$.delete)for(var i=e.$.delete,o=0;o<i.length;o++){var a=i[o];this.ensuredelete(a),this.emit(a[0]+"chgd",this),console.log(a+"chgd"),this.emit(a+"chgd",this),this._chkRegEvent(a+"chgd")}if(e.$.set)for(var i=e.$.set,o=0;o<i.length;o++){var a=i[o];this.ensuredelete(a)}delete e.$}f.recursive(this,e),this._enumAttr(e,"",function(e,t){console.log(e+"chgd"),n.emit(e+"chgd",t),n._chkRegEvent(e+"chgd")})}},{key:"ensuredelete",value:function(e){for(var t=this,n=0;n<e.length-1;n++){if(!t[e[n]])return!1;t=t[e[n]]}t&&(Array.isArray(t)&&t.length-1==e[e.length-1]?t.length--:delete t[e[e.length-1]])}}]),t}(p),y=(window.io=n(165),n(209)),w=n(19)._noop,b=function(){function e(e){return Laya.Browser.onAndroid?void t.requestPermissions([t.RECORD_AUDIO,t.CAMERA,t.RECORD_AUDIO],function(t){return t.hasPermission?e():void e("user canceled")},function(){e("something wrong")}):e()}var t=!!window.cordova&&cordova.plugins.permissions||{checkPermission:function(e,t){t({hasPermission:!0})}};return e}();y.setSocketUrl("http://ws.1357g.com:19999/"),y.setVideoDims(100,100,15);var C=console.log.bind(console,"audioroute ret");document.addEventListener("audioroute-changed",function(e){"route-config-change"==e.reason&&cordova.plugins.audioroute.currentOutputs(function(e){console.log("audio chg to",e),"builtin-receiver"==e&&cordova.plugins.audioroute.overrideOutput("speaker",C,C)},C)});var E=document.getElementById("layaContainer"),k=document.getElementById("layaCanvas"),R=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.gamedata=n.scene=new v,n._seatNumber=e.seatNumber||1,n._calls={};var i=n,a=n.gamedata;return a.on("inited",function(){e.disableRtc||null==e.easyrtcApp||b(function(t){y.initMediaSource(function(){if(!i.hasQuit){i.disableMicrophone(),i.onVideoActived&&i.onVideoActived(),i.chgVoiceBtnFunc();var t=i.icon2Video(0,!0);t&&(y.setVideoObjectSrc(t,y.getLocalStream()),c(e.easyrtcApp,function(e,t){return e?console.log(e):void(i.hasQuit||(i.afterRtcConnected(t),y.setDisconnectListener(function(){y.showError("LOST-CONNECTION","Lost connection to signaling server"),c(function(e,t){return e?console.log(e):void i.afterRtcConnected(t)})})))}))}},w)})}),n}return i(t,e),d(t,[{key:"afterCreateView",value:function(){function e(){r=!0,console.log("rec canceled"),window.stopRecord&&window.stopRecord(),n&&(n.hide(),n=null),Laya.SoundManager.setMusicVolume(1)}this.assignAllBtns();var t=this.getVoiceBtn();if(t){var n=null,r=!1;t.on("mousedown",null,function(){window.startRecord&&(r=!1,Laya.SoundManager.setMusicVolume(.6),setTimeout(function(){r||(window.startRecord(),Laya.SoundManager.setMusicVolume(.2),g.RecWin&&(n=g.RecWin.inst,n.show()))},200))}),t.on("mouseup",null,function(){n?(setTimeout(function(){window.stopRecord&&window.stopRecord(function(e,t){return Laya.SoundManager.setMusicVolume(1),e?console.log(e):void(t&&_socket.sendp({c:"table.voice",token:t}))})},300),n.hide(),n=null):e()}),t.on("mouseout",null,e)}}},{key:"getUserMediaRect",value:function(e){l.fail("要使用视屏，必须自己实现这个函数。该函数返回对应seat(id)的视频区域，一般而言是用户的头像区")}},{key:"getVoiceBtn",value:function(){l.fail("自行实现这个函数，返回语音按钮")}},{key:"onVideoActived",value:function(){}},{key:"msg",value:function(e){return(e.gamedata||e.scene)&&this.gamedata._update(e.gamedata||e.scene),!0}},{key:"active",value:function(){var e=this;_socket.sendp({c:"createInviteCode"}),netmsg.once("inviteCode",null,function(t){e.inviteCode=t.v,window.preInvite&&window.preInvite(t.v,e.opt)}),this.mySeat=null,this.video2Icon(0),this._calls={}}},{key:"deactive",value:function(){this.gamedata.removeAllListeners(),this.hasQuit=!0,y.setDisconnectListener(null),y.disconnect();for(var e=E.getElementsByTagName("video"),t=0;t<e.length;t++)E.removeChild(e[t]);this._calls={}}},{key:"locateMe",value:function(e){if(!e)return-1;if(Array.isArray(e)){for(var t=0;t<e.length;t++){var n=e[t];if(n&&n.user&&n.user.id==h.id)return t}return-1}if("object"==("undefined"==typeof e?"undefined":u(e))){for(var t in e){var n=e[t];if(n&&n.user&&n.user.id==h.id)return t}return-1}return-1}},{key:"createHTMLDiv",value:function(e){var t={x:e.x,y:e.y,w:e.width,h:e.height},n=$("#layaCanvas"),r=Laya.stage.clientScaleX,i=Laya.stage.clientScaleY;t.x=t.x*r,t.y=t.y*i,t.w=t.w*r,t.h=t.h*i;var o=$('<div class="card" style="position:absolute;left:'+t.x+"px; top:"+t.y+"px; width:"+t.w+"px; height:"+t.h+'px"/>');return o.css("transform",n.css("transform")),o.css("transform-origin",""+-t.x+"px "+-t.y+"px"),$("#layaContainer").append(o),o}},{key:"createHTMLVideo",value:function(e){var t=document.createElement("video"),n=t.style,r=k.width/(960*(Laya.Browser.onIOS?devicePixelRatio:1)),i=k.width/(960*devicePixelRatio),o=Number(k.style.transform.split(",")[2])==-1;return n.left=(o?-e.y:e.x)*i+"px",n.top=(o?e.x:e.y)*i+"px",n.width=e.width*r+"px",n.height=e.height*r+"px",n.transform=k.style.transform,n.transformOrigin=k.style.transformOrigin,n.position="absolute",n["z-index"]=9999999,E.appendChild(t),t}},{key:"findUserLocalSeat",value:function(e){for(var t=this.gamedata,n=0;n<t.seats.length;n++){var r=t.seats[n];if(r&&r.user.id==e)return this.serverSeatToLocal(n)}return null}},{key:"serverSeatToLocal",value:function(e){return null==this.mySeat&&(this.mySeat=locateMe(this.gamedata.seats)),(this._seatNumber+e-this.mySeat)%this._seatNumber}},{key:"pausemsg",value:function(e){window.msgloop.pause(),e(function(){window.msgloop.resume()})}},{key:"chgVoiceBtnFunc",value:function(){var e=this;window.startRecord=function(){e.enableMicrophone()},window.stopRecord=function(t){e.enableMicrophone(!1),t&&t(null)}}},{key:"afterRtcConnected",value:function(e){if(!this.hasQuit){_socket.sendp({c:"table.extenddata",rtcid:e});var t=this.gamedata;t.once("extenddatachgd",function(){for(var e in t.extenddata)e!=h.id&&y.call(t.extenddata[e],w,w,w)})}}},{key:"icon2Video",value:function(e,t){var n=this.getUserMediaRect(e);if(!n)return null;console.log("chg",e,"to video");var r=createHTMLVideo(n,t);return this._calls[e]=r,n.visible=!1,r}},{key:"video2Icon",value:function(e){var t=this.getUserMediaRect(e);return t?(console.log("chg",e,"back to icon",t.url),
t.visible=!0,void(this._calls[e]&&(E.removeChild(this._calls[e]),delete this._calls[e]))):null}},{key:"enableMicrophone",value:function(e){y.enableMicrophone(null==e||e)}},{key:"disableMicrophone",value:function(){y.enableMicrophone(!1)}},{key:"enableCamera",value:function(e){y.enableCamera(null==e||e)}},{key:"disableCamera",value:function(){y.enableCamera(!1)}}],[{key:"create",value:function(e,t){l.fail("必须自己实现create")}}]),t}(m);e.exports=R},function(e,t,n){(function(t){"use strict";/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function o(e){return Object.prototype.toString.call(e)}function a(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function s(e){if(b.isFunction(e)){if(k)return e.name;var t=e.toString(),n=t.match(S);return n&&n[1]}}function c(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function u(e){if(k||!b.isFunction(e))return b.inspect(e);var t=s(e),n=t?": "+t:"";return"[Function"+n+"]"}function d(e){return c(u(e.actual),128)+" "+e.operator+" "+c(u(e.expected),128)}function l(e,t,n,r,i){throw new R.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function f(e,t){e||l(e,!0,t,"==",R.ok)}function p(e,t,n,s){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(b.isDate(e)&&b.isDate(t))return e.getTime()===t.getTime();if(b.isRegExp(e)&&b.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(a(e)&&a(t)&&o(e)===o(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;s=s||{actual:[],expected:[]};var c=s.actual.indexOf(e);return c!==-1&&c===s.expected.indexOf(t)||(s.actual.push(e),s.expected.push(t),g(e,t,n,s))}return n?e===t:e==t}function h(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function g(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(b.isPrimitive(e)||b.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=h(e),o=h(t);if(i&&!o||!i&&o)return!1;if(i)return e=E.call(e),t=E.call(t),p(e,t,n);var a,s,c=P(e),u=P(t);if(c.length!==u.length)return!1;for(c.sort(),u.sort(),s=c.length-1;s>=0;s--)if(c[s]!==u[s])return!1;for(s=c.length-1;s>=0;s--)if(a=c[s],!p(e[a],t[a],n,r))return!1;return!0}function m(e,t,n){p(e,t,!0)&&l(e,t,n,"notDeepStrictEqual",m)}function v(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&t.call({},e)===!0}function y(e){var t;try{e()}catch(e){t=e}return t}function w(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=y(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&l(i,n,"Missing expected exception"+r);var o="string"==typeof r,a=!e&&b.isError(i),s=!e&&i&&!n;if((a&&o&&v(i,n)||s)&&l(i,n,"Got unwanted exception"+r),e&&i&&n&&!v(i,n)||!e&&i)throw i}var b=n(21),C=Object.prototype.hasOwnProperty,E=Array.prototype.slice,k=function(){return"foo"===function(){}.name}(),R=e.exports=f,S=/\s*function\s+([^\(\s]*)\s*/;R.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=d(this),this.generatedMessage=!0);var t=e.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=s(t),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},b.inherits(R.AssertionError,Error),R.fail=l,R.ok=f,R.equal=function(e,t,n){e!=t&&l(e,t,n,"==",R.equal)},R.notEqual=function(e,t,n){e==t&&l(e,t,n,"!=",R.notEqual)},R.deepEqual=function(e,t,n){p(e,t,!1)||l(e,t,n,"deepEqual",R.deepEqual)},R.deepStrictEqual=function(e,t,n){p(e,t,!0)||l(e,t,n,"deepStrictEqual",R.deepStrictEqual)},R.notDeepEqual=function(e,t,n){p(e,t,!1)&&l(e,t,n,"notDeepEqual",R.notDeepEqual)},R.notDeepStrictEqual=m,R.strictEqual=function(e,t,n){e!==t&&l(e,t,n,"===",R.strictEqual)},R.notStrictEqual=function(e,t,n){e===t&&l(e,t,n,"!==",R.notStrictEqual)},R.throws=function(e,t,n){w(!0,e,t,n)},R.doesNotThrow=function(e,t,n){w(!1,e,t,n)},R.ifError=function(e){if(e)throw e};var P=Object.keys||function(e){var t=[];for(var n in e)C.call(e,n)&&t.push(n);return t}}).call(t,function(){return this}())},function(e,t,n){function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=i(e),o=r.source,u=r.id,d=r.path,l=c[u]&&d in c[u].nsps,f=t.forceNew||t["force new connection"]||!1===t.multiplex||l;return f?(s("ignoring socket cache for %s",o),n=a(o,t)):(c[u]||(s("new io instance for %s",o),c[u]=a(o,t)),n=c[u]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}var i=n(166),o=n(171),a=n(177),s=n(168)("socket.io-client");e.exports=t=r;var c=t.managers={};t.protocol=o.protocol,t.connect=r,t.Manager=n(177),t.Socket=n(204)},function(e,t,n){(function(t){function r(e,n){var r=e;n=n||t.location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof n?n.protocol+"//"+e:"https://"+e),o("parse %s",e),r=i(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var a=r.host.indexOf(":")!==-1,s=a?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port,r.href=r.protocol+"://"+s+(n&&n.port===r.port?"":":"+r.port),r}var i=n(167),o=n(168)("socket.io-client:url");e.exports=r}).call(t,function(){return this}())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");i!=-1&&o!=-1&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[r[c]]=a[c]||"";return i!=-1&&o!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t,n){(function(r){function i(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r)}}function a(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof r&&"env"in r&&(e=r.env.DEBUG),e}function u(){try{return window.localStorage}catch(e){}}t=e.exports=n(169),t.log=a,t.formatArgs=o,t.save=s,t.load=c,t.useColors=i,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,n(9))},function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function i(e){function n(){if(n.enabled){var e=n,r=+new Date,i=r-(u||r);e.diff=i,e.prev=u,e.curr=r,u=r;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var s=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;s++;var i=t.formatters[r];if("function"==typeof i){var a=o[s];n=i.call(e,a),o.splice(s,1),s--}return n}),t.formatArgs.call(e,o);var c=n.log||t.log||console.log.bind(console);c.apply(e,o)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),"function"==typeof t.init&&t.init(n),n}function o(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&(e=n[i].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function s(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=i.debug=i.default=i,t.coerce=c,t.disable=a,t.enable=o,t.enabled=s,t.humanize=n(170),t.names=[],t.skips=[],t.formatters={};var u},function(e,t){function n(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*d;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return o(e,u,"day")||o(e,c,"hour")||o(e,s,"minute")||o(e,a,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,d=365.25*u;e.exports=function(e,t){t=t||{};var o=typeof e;if("string"===o&&e.length>0)return n(e);if("number"===o&&isNaN(e)===!1)return t.long?i(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(){}function i(e){var n=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data&&(n+=JSON.stringify(e.data)),l("encoded %j as %s",e,n),n}function o(e,t){function n(e){var n=h.deconstructPacket(e),r=i(n.packet),o=n.buffers;o.unshift(r),t(o)}h.removeBlobs(e,n)}function a(){this.reconstructor=null}function s(e){var n=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return d();if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var i="";"-"!==e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(n+1))for(r.nsp="";++n;){var o=e.charAt(n);if(","===o)break;if(r.nsp+=o,n===e.length)break}else r.nsp="/";var a=e.charAt(n+1);if(""!==a&&Number(a)==a){for(r.id="";++n;){var o=e.charAt(n);if(null==o||Number(o)!=o){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=Number(r.id)}return e.charAt(++n)&&(r=c(r,e.substr(n))),l("decoded %s as %j",e,r),r}function c(e,t){try{e.data=JSON.parse(t)}catch(e){return d()}return e}function u(e){this.reconPack=e,this.buffers=[]}function d(){return{type:t.ERROR,data:"parser error"}}var l=n(168)("socket.io-parser"),f=n(172),p=n(173),h=n(175),g=n(176);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=a,r.prototype.encode=function(e,n){if(e.type!==t.EVENT&&e.type!==t.ACK||!p(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),l("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)o(e,n);else{var r=i(e);n([r])}},f(a.prototype),a.prototype.add=function(e){var n;if("string"==typeof e)n=s(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new u(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!g(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,this.emit("decoded",n))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=h.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(t){function r(e){if(!e||"object"!=typeof e)return!1;if(i(e)){for(var n=0,o=e.length;n<o;n++)if(r(e[n]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||"function"==typeof t.ArrayBuffer&&e instanceof ArrayBuffer||a&&e instanceof Blob||s&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return r(e.toJSON(),!0);for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)&&r(e[c]))return!0;return!1}var i=n(174),o=Object.prototype.toString,a="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),s="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);e.exports=r}).call(t,function(){return this}())},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){function r(e,t){if(!e)return e;if(a(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(o(e)){for(var i=new Array(e.length),s=0;s<e.length;s++)i[s]=r(e[s],t);return i}if("object"==typeof e&&!(e instanceof Date)){var i={};for(var c in e)i[c]=r(e[c],t);return i}return e}function i(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(o(e))for(var n=0;n<e.length;n++)e[n]=i(e[n],t);else if("object"==typeof e)for(var r in e)e[r]=i(e[r],t);return e}var o=n(174),a=n(176),s=Object.prototype.toString,c="function"==typeof e.Blob||"[object BlobConstructor]"===s.call(e.Blob),u="function"==typeof e.File||"[object FileConstructor]"===s.call(e.File);t.deconstructPacket=function(e){var t=[],n=e.data,i=e;return i.data=r(n,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=i(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){function n(e,s,d){if(!e)return e;if(c&&e instanceof Blob||u&&e instanceof File){r++;var l=new FileReader;l.onload=function(){d?d[s]=this.result:i=this.result,--r||t(i)},l.readAsArrayBuffer(e)}else if(o(e))for(var f=0;f<e.length;f++)n(e[f],f,e);else if("object"==typeof e&&!a(e))for(var p in e)n(e[p],p,e)}var r=0,i=e;n(i),r||t(i)}}).call(t,function(){return this}())},function(e,t){(function(t){function n(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=n}).call(t,function(){return this}())},function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=t.autoConnect!==!1,this.autoConnect&&this.open()}var i=n(178),o=n(204),a=n(172),s=n(171),c=n(206),u=n(207),d=n(168)("socket.io-client:manager"),l=n(202),f=n(208),p=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},a(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(d("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;d("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=c(n,"open",function(){r.onopen(),e&&e()}),a=c(n,"error",function(t){if(d("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;d("connect attempt will timeout after %d",s);var u=setTimeout(function(){d("connect attempt timed out after %d",s),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(o),this.subs.push(a),this},r.prototype.onopen=function(){d("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",u(this,"ondata"))),this.subs.push(c(e,"ping",u(this,"onping"))),this.subs.push(c(e,"pong",u(this,"onpong"))),this.subs.push(c(e,"error",u(this,"onerror"))),this.subs.push(c(e,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){d("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function n(){~l(i.connecting,r)||i.connecting.push(r)}var r=this.nsps[e];if(!r){r=new o(this,e,t),this.nsps[e]=r;var i=this;r.on("connecting",n),r.on("connect",function(){r.id=i.generateId(e)}),this.autoConnect&&n()}return r},r.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){d("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){d("cleanup");for(var e=this.subs.length,t=0;t<e;t++){var n=this.subs.shift();n.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){d("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){d("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();d("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(d("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(d("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(d("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(179)},function(e,t,n){e.exports=n(180),e.exports.parser=n(187)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=d(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=d(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var i="object"==typeof t&&t;i.global===i&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function i(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var o=n(181),a=n(172),s=n(168)("engine.io-client:socket"),c=n(202),u=n(187),d=n(167),l=n(203),f=n(196);e.exports=r,r.priorWebsocketSuccess=!1,a(r.prototype),r.protocol=u.protocol,r.Socket=r,r.Transport=n(186),r.transports=n(181),r.parser=n(187),r.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=i(this.query);t.EIO=u.protocol,t.transport=e;var n=this.transportOptions[e]||{};this.id&&(t.sid=this.id);var r=new o[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0});return r},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(f.onlyBinaryUpgrades){var t=!this.supportsBinary&&f.transport.supportsBinary;l=l||t}l||(s('probe transport "%s" opened',e),d.send([{type:"ping",data:"probe"}]),d.once("packet",function(t){if(!l)if("pong"===t.type&&"probe"===t.data){if(s('probe transport "%s" pong',e),f.upgrading=!0,f.emit("upgrading",d),!d)return;r.priorWebsocketSuccess="websocket"===d.name,s('pausing current transport "%s"',f.transport.name),f.transport.pause(function(){l||"closed"!==f.readyState&&(s("changing transport and sending upgrade packet"),u(),f.setTransport(d),d.send([{type:"upgrade"}]),f.emit("upgrade",d),d=null,f.upgrading=!1,f.flush())})}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=d.name,f.emit("upgradeError",n)}}))}function n(){l||(l=!0,u(),d.close(),d=null)}function i(t){var r=new Error("probe error: "+t);r.transport=d.name,n(),s('probe transport "%s" failed because of error: %s',e,t),f.emit("upgradeError",r)}function o(){i("transport closed")}function a(){i("socket closed")}function c(e){d&&e.name!==d.name&&(s('"%s" works - aborting "%s"',e.name,d.name),n())}function u(){d.removeListener("open",t),d.removeListener("error",i),d.removeListener("close",o),f.removeListener("close",a),f.removeListener("upgrading",c)}s('probing transport "%s"',e);var d=this.createTransport(e,{probe:1}),l=!1,f=this;r.priorWebsocketSuccess=!1,d.once("open",t),d.once("error",i),d.once("close",o),this.once("close",a),this.once("upgrading",c),d.open()},r.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(l(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){n=n||{},n.compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),s("socket closing - telling transport to close"),
r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){s("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~c(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e){function r(t){var n,r=!1,s=!1,c=!1!==t.jsonp;if(e.location){var u="https:"===location.protocol,d=location.port;d||(d=u?443:80),r=t.hostname!==location.hostname||d!==t.port,s=t.secure!==u}if(t.xdomain=r,t.xscheme=s,n=new i(t),"open"in n&&!t.forceJSONP)return new o(t);if(!c)throw new Error("JSONP disabled");return new a(t)}var i=n(182),o=n(184),a=n(199),s=n(200);t.polling=r,t.websocket=s}).call(t,function(){return this}())},function(e,t,n){(function(t){var r=n(183);e.exports=function(e){var n=e.xdomain,i=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!i&&o)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){(function(t){function r(){}function i(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==n}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var s=n(182),c=n(185),u=n(172),d=n(197),l=n(168)("engine.io-client:polling-xhr");e.exports=i,e.exports.Request=o,d(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new o(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},i.prototype.doPoll=function(){l("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},u(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new s(e),r=this;try{l("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.extraHeaders[i])}}catch(e){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState){var e;try{e=n.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(n.responseType="arraybuffer")}4===n.readyState&&(200===n.status||1223===n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},l("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}t.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}t.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof t.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",a):t.addEventListener&&t.addEventListener("beforeunload",a,!1))}).call(t,function(){return this}())},function(e,t,n){function r(e){var t=e&&e.forceBase64;d&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(186),o=n(196),a=n(187),s=n(197),c=n(198),u=n(168)("engine.io-client:polling");e.exports=r;var d=function(){var e=n(182),t=new e({xdomain:!1});return null!=t.responseType}();s(r,i),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){u("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||t()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;u("polling got data %s",e);var n=function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)};a.decodePayload(e,this.socket.binaryType,n),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){u("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=n(187),o=n(172);e.exports=r,o(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){(function(e){function r(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=y[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return r(a.buffer)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}function a(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(v)return o(e,n,r);var i=new Uint8Array(1);i[0]=y[e.type];var a=new C([i.buffer,e.data]);return r(a)}function s(e){try{e=h.decode(e,{strict:!1})}catch(e){return!1}return e}function c(e,t,n){for(var r=new Array(e.length),i=p(e.length,n),o=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},a=0;a<e.length;a++)o(a,e[a],i)}var u,d=n(188),l=n(189),f=n(191),p=n(192),h=n(193);e&&e.ArrayBuffer&&(u=n(194));var g="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),m="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),v=g||m;t.protocol=3;var y=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},w=d(y),b={type:"error",data:"parser error"},C=n(195);t.encodePacket=function(t,n,o,s){"function"==typeof n&&(s=n,n=!1),"function"==typeof o&&(s=o,o=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return i(t,n,s);if(C&&c instanceof e.Blob)return a(t,n,s);if(c&&c.base64)return r(t,s);var u=y[t.type];return void 0!==t.data&&(u+=o?h.encode(String(t.data),{strict:!1}):String(t.data)),s(""+u)},t.encodeBase64Packet=function(n,r){var i="b"+t.packets[n.type];if(C&&n.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(i+e)},o.readAsDataURL(n.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var s=new Uint8Array(n.data),c=new Array(s.length),u=0;u<s.length;u++)c[u]=s[u];a=String.fromCharCode.apply(null,c)}return i+=e.btoa(a),r(i)},t.decodePacket=function(e,n,r){if(void 0===e)return b;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&(e=s(e),e===!1))return b;var i=e.charAt(0);return Number(i)==i&&w[i]?e.length>1?{type:w[i],data:e.substring(1)}:{type:w[i]}:b}var o=new Uint8Array(e),i=o[0],a=f(e,1);return C&&"blob"===n&&(a=new C([a])),{type:w[i],data:a}},t.decodeBase64Packet=function(e,t){var n=w[e.charAt(0)];if(!u)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=u.decode(e.substr(1));return"blob"===t&&C&&(r=new C([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){function i(e){return e.length+":"+e}function o(e,r){t.encodePacket(e,!!a&&n,!1,function(e){r(null,i(e))})}"function"==typeof n&&(r=n,n=null);var a=l(e);return n&&a?C&&!v?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void c(e,o,function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var i;if(""===e)return r(b,0,1);for(var o,a,s="",c=0,u=e.length;c<u;c++){var d=e.charAt(c);if(":"===d){if(""===s||s!=(o=Number(s)))return r(b,0,1);if(a=e.substr(c+1,o),s!=a.length)return r(b,0,1);if(a.length){if(i=t.decodePacket(a,n,!1),b.type===i.type&&b.data===i.data)return r(b,0,1);var l=r(i,c+o,u);if(!1===l)return}c+=o,s=""}else s+=d}return""!==s?r(b,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})}return e.length?void c(e,r,function(e,t){var r=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),i=new Uint8Array(r),o=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}t?i[o++]=0:i[o++]=1;for(var s=n.byteLength.toString(),a=0;a<s.length;a++)i[o++]=parseInt(s[a]);i[o++]=255;for(var r=new Uint8Array(n),a=0;a<r.length;a++)i[o++]=r[a]}),n(i.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,a=o.toString(),s=new Uint8Array(a.length+1),i=0;i<a.length;i++)s[i]=parseInt(a[i]);if(s[a.length]=255,C){var c=new C([t.buffer,s.buffer,e]);n(null,c)}})}c(e,r,function(e,t){return n(new C(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),s=0===a[0],c="",u=1;255!==a[u];u++){if(c.length>310)return r(b,0,1);c+=a[u]}i=f(i,2+c.length),c=parseInt(c);var d=f(i,0,c);if(s)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var l=new Uint8Array(d);d="";for(var u=0;u<l.length;u++)d+=String.fromCharCode(l[u])}o.push(d),i=f(i,c)}var p=o.length;o.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,p)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){(function(t){function r(e){if(!e||"object"!=typeof e)return!1;if(i(e)){for(var n=0,o=e.length;n<o;n++)if(r(e[n]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||"function"==typeof t.ArrayBuffer&&e instanceof ArrayBuffer||a&&e instanceof Blob||s&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return r(e.toJSON(),!0);for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)&&r(e[c]))return!0;return!1}var i=n(190),o=Object.prototype.toString,a="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),s="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);e.exports=r}).call(t,function(){return this}())},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=i[a];return o.buffer}},function(e,t){function n(e,t,n){function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}var o=!1;return n=n||r,i.count=e,0===e?t():i}function r(){}e.exports=n},function(e,t,n){var r;(function(e,i){!function(o){function a(e){for(var t,n,r=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function s(e){for(var t,n=e.length,r=-1,i="";++r<n;)t=e[r],t>65535&&(t-=65536,i+=b(t>>>10&1023|55296),t=56320|1023&t),i+=b(t);return i}function c(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(e,t){return b(e>>t&63|128)}function d(e,t){if(0==(4294967168&e))return b(e);var n="";return 0==(4294965248&e)?n=b(e>>6&31|192):0==(4294901760&e)?(c(e,t)||(e=65533),n=b(e>>12&15|224),n+=u(e,6)):0==(4292870144&e)&&(n=b(e>>18&7|240),n+=u(e,12),n+=u(e,6)),n+=b(63&e|128)}function l(e,t){t=t||{};for(var n,r=!1!==t.strict,i=a(e),o=i.length,s=-1,c="";++s<o;)n=i[s],c+=d(n,r);return c}function f(){if(w>=y)throw Error("Invalid byte index");var e=255&v[w];if(w++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function p(e){var t,n,r,i,o;if(w>y)throw Error("Invalid byte index");if(w==y)return!1;if(t=255&v[w],w++,0==(128&t))return t;if(192==(224&t)){if(n=f(),o=(31&t)<<6|n,o>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if(n=f(),r=f(),o=(15&t)<<12|n<<6|r,o>=2048)return c(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=f(),r=f(),i=f(),o=(7&t)<<18|n<<12|r<<6|i,o>=65536&&o<=1114111))return o;throw Error("Invalid UTF-8 detected")}function h(e,t){t=t||{};var n=!1!==t.strict;v=a(e),y=v.length,w=0;for(var r,i=[];(r=p(n))!==!1;)i.push(r);return s(i)}var g="object"==typeof t&&t,m=("object"==typeof e&&e&&e.exports==g&&e,"object"==typeof i&&i);m.global!==m&&m.window!==m||(o=m);var v,y,w,b=String.fromCharCode,C={version:"2.1.2",encode:l,decode:h};r=function(){return C}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(3)(e),function(){return this}())},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,a,s=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var d=new ArrayBuffer(s),l=new Uint8Array(d);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],l[u++]=r<<2|i>>4,l[u++]=(15&i)<<4|o>>2,l[u++]=(3&o)<<6|63&a;return d}}()},function(e,t){(function(t){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new o;n(e);for(var i=0;i<e.length;i++)r.append(e[i]);return t.type?r.getBlob(t.type):r.getBlob()}function i(e,t){return n(e),new Blob(e,t||{})}var o=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,a=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(e){return!1}}(),s=a&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(e){return!1}}(),c=o&&o.prototype.append&&o.prototype.getBlob;e.exports=function(){return a?s?t.Blob:i:c?r:void 0}()}).call(t,function(){return this}())},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){var t="";do t=a[e%s]+t,e=Math.floor(e/s);while(e>0);return t}function r(e){var t=0;for(d=0;d<e.length;d++)t=t*s+c[e.charAt(d)];return t}function i(){var e=n(+new Date);return e!==o?(u=0,o=e):e+"."+n(u++)}for(var o,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,c={},u=0,d=0;d<s;d++)c[a[d]]=d;i.encode=n,i.decode=r,e.exports=i},function(e,t,n){(function(t){function r(){}function i(e){o.call(this,e),this.query=this.query||{},s||(t.___eio||(t.___eio=[]),s=t.___eio),this.index=s.length;var n=this;s.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var o=n(185),a=n(197);e.exports=i;var s,c=/\n/g,u=/\\n/g;a(i,o),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';o=document.createElement(e)}catch(e){o=document.createElement("iframe"),o.name=i.iframeId,o.src="javascript:0"}o.id=i.iframeId,i.form.appendChild(o),i.iframe=o}var i=this;if(!this.form){var o,a=document.createElement("form"),s=document.createElement("textarea"),d=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=d,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),r(),e=e.replace(u,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=l&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(f=i),o.call(this,e)}var i,o=n(186),a=n(187),s=n(196),c=n(197),u=n(198),d=n(168)("engine.io-client:websocket"),l=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{i=n(201)}catch(e){}var f=l;f||"undefined"!=typeof window||(f=i),e.exports=r,c(r,o),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new f(e,t):new f(e):new f(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){function n(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var i=e.length,o=0,s=i;o<s;o++)!function(e){a.encodePacket(e,r.supportsBinary,function(o){if(!r.usingBrowserWebSocket){var a={};if(e.options&&(a.compress=e.options.compress),r.perMessageDeflate){var s="string"==typeof o?t.Buffer.byteLength(o):o.length;s<r.perMessageDeflate.threshold&&(a.compress=!1)}}try{r.usingBrowserWebSocket?r.ws.send(o):r.ws.send(o,a)}catch(e){d("websocket closed before onclose event")}--i||n()})}(e[o])},r.prototype.onClose=function(){o.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===r.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(i,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,n){function r(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var i=n(171),o=n(172),a=n(205),s=n(206),c=n(207),u=n(168)("socket.io-client:socket"),d=n(196);e.exports=t=r;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=o.prototype.emit;o(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",c(this,"onopen")),s(e,"packet",c(this,"onpacket")),s(e,"close",c(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(l.hasOwnProperty(e))return f.apply(this,arguments),this;var t=a(arguments),n={type:i.EVENT,data:t};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?d.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(e);break;case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:this.onack(e);break;case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=a(arguments);u("sending ack %j",r),t.packet({type:i.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){function n(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}e.exports=n},function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}e.exports=n},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t,n){var r,i,o,r,a,s,s,o,r,c,r,o,u,d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
	  Script: easyrtc_lang.js
	
	    Provides lang file.
	
	  About: License
	
	    Copyright (c) 2016, Priologic Software Inc.
	    All rights reserved.
	
	    Redistribution and use in source and binary forms, with or without
	    modification, are permitted provided that the following conditions are met:
	
	        * Redistributions of source code must retain the above copyright notice,
	          this list of conditions and the following disclaimer.
	        * Redistributions in binary form must reproduce the above copyright
	          notice, this list of conditions and the following disclaimer in the
	          documentation and/or other materials provided with the distribution.
	
	    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
	    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
	    ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
	    LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
	    CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
	    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
	    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
	    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
	    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
	    POSSIBILITY OF SUCH DAMAGE.
	*/
!function(o,a){r=a,!(i="function"==typeof r?r.call(t,n,t,e):r)}(void 0,function(e){"use strict";return{unableToEnterRoom:"Unable to enter room {0} because {1}",resolutionWarning:"Requested video size of {0}x{1} but got size of {2}x{3}",badUserName:"Illegal username {0}",localMediaError:"Error getting local media stream: {0}",miscSignalError:"Miscellaneous error from signalling server. It may be ignorable.",noServer:"Unable to reach the EasyRTC signalling server.",badsocket:"Socket.io connect event fired with bad websocket.",icf:"Internal communications failure",statsNotSupported:"call statistics not supported by this browser, try Chrome.",noWebrtcSupport:"Your browser doesn't appear to support WebRTC.",gumFailed:"Failed to get access to local media. Error code was {0}.",requireAudioOrVideo:"At least one of audio and video must be provided"}}),function(n){if("object"===d(t)&&"undefined"!=typeof e)e.exports=n();else{o=[],r=n,!(a="function"==typeof r?r.apply(t,o):r)}}(function(){return function e(t,n,r){function i(a,c){if(!n[a]){if(!t[a]){var u="function"==typeof s&&s;if(!c&&u)return s(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof s&&s,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){var r={};r.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},r.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getDtlsParameters=function(e,t){var n=r.splitLines(e);n=n.concat(r.splitLines(t));var i=n.filter(function(e){return 0===e.indexOf("a=fingerprint:")})[0].substr(14),o={role:"auto",fingerprints:[{algorithm:i.split(" ")[0],value:i.split(" ")[1]}]};return o},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);n=n.concat(r.splitLines(t));var i={usernameFragment:n.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return i},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e),i=n[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=r.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c=r.parseRtpMap(s),u=r.matchPrefix(e,"a=fmtp:"+a+" ");switch(c.parameters=u.length?r.parseFmtp(u[0]):{},c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(r.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";return n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}),n+="a=rtcp-mux\r\n"},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{payloadType:e.payloadType,ssrc:t}};n.push(r),o&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var d=r.matchPrefix(e,"b=");return d.length&&(0===d[0].indexOf("b=TIAS:")?d=parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")&&(d=parseInt(d[0].substr(5),10)),n.forEach(function(e){e.maxBitrate=d})),n},r.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n"},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},t.exports=r},{}],2:[function(e,t,n){!function(){var n=e("./utils").log,r=e("./utils").browserDetails;t.exports.browserDetails=r,t.exports.extractVersion=e("./utils").extractVersion,t.exports.disableLog=e("./utils").disableLog;var i=e("./chrome/chrome_shim")||null,o=e("./edge/edge_shim")||null,a=e("./firefox/firefox_shim")||null,s=e("./safari/safari_shim")||null;switch(r.browser){case"opera":case"chrome":if(!i||!i.shimPeerConnection)return void n("Chrome shim is not included in this adapter release.");n("adapter.js shimming chrome."),t.exports.browserShim=i,i.shimGetUserMedia(),i.shimMediaStream(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"firefox":if(!a||!a.shimPeerConnection)return void n("Firefox shim is not included in this adapter release.");n("adapter.js shimming firefox."),t.exports.browserShim=a,a.shimGetUserMedia(),a.shimSourceObject(),a.shimPeerConnection(),a.shimOnTrack();break;case"edge":if(!o||!o.shimPeerConnection)return void n("MS edge shim is not included in this adapter release.");n("adapter.js shimming edge."),t.exports.browserShim=o,o.shimGetUserMedia(),o.shimPeerConnection();break;case"safari":if(!s)return void n("Safari shim is not included in this adapter release.");n("adapter.js shimming safari."),t.exports.browserShim=s,s.shimGetUserMedia();break;default:n("Unsupported browser!")}}()},{"./chrome/chrome_shim":3,"./edge/edge_shim":5,"./firefox/firefox_shim":7,"./safari/safari_shim":9,"./utils":10}],3:[function(e,t,n){var r=e("../utils.js").log,i=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!==("undefined"==typeof window?"undefined":d(window))||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r=new Event("track");r.track=n.track,r.receiver={track:n.track},r.streams=[e.stream],t.dispatchEvent(r)}),e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"===("undefined"==typeof window?"undefined":d(window))&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),void e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):void(this.src="")}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e,t){var n=new Map(Object.keys(e).map(function(t){return[t,e[t]]}));return t=t||e,Object.keys(t).forEach(function(e){n[e]=t[e]}),n};if(arguments.length>=2){var c=function(e){o[1](s(a(e)))};return i.apply(this,[c,arguments[0]])}return new Promise(function(t,n){1===o.length&&"object"===("undefined"==typeof e?"undefined":d(e))?i.apply(r,[function(e){t(s(a(e)))},n]):i.apply(r,[function(e){t(s(a(e),e.result()))},n])}).then(t,n)},n},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"===d(arguments[0])){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":10,"./getusermedia":4}],4:[function(e,t,n){var r=e("../utils.js").log;t.exports=function(){var e=function(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===d(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if(t=JSON.parse(JSON.stringify(t)),t&&t.audio&&(t.audio=e(t.audio)),t&&"object"===d(t.video)){var i=t.video.facingMode;if(i=i&&("object"===("undefined"==typeof i?"undefined":d(i))?i:{ideal:i}),i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete t.video.facingMode,"environment"===i.exact||"environment"===i.ideal))return navigator.mediaDevices.enumerateDevices().then(function(o){o=o.filter(function(e){return"videoinput"===e.kind});var a=o.find(function(e){return e.label.toLowerCase().indexOf("back")!==-1})||o.length&&o[o.length-1];return a&&(t.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},i=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};navigator.getUserMedia=i;var o=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:o,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return a(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return o(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":10}],5:[function(e,t,n){var r=e("sdp"),i=e("../utils").browserDetails,o={shimPeerConnection:function(){if(window.RTCIceGatherer){window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e});var e=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(t){e.set.call(this,t);var n=new Event("enabled");n.enabled=t,this.dispatchEvent(n)}})}window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&e.indexOf("transport=udp")!==-1&&e.indexOf("turn:[")===-1||0===e.indexOf("stun:")&&i.version>=14393})[0],!!t}return!1})}this._config=e,this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){var r=!n.candidate||0===Object.keys(n.candidate).length;if(r)for(var i=1;i<t.length;i++)t[i].indexOf("\r\na=end-of-candidates\r\n")===-1&&(t[i]+="a=end-of-candidates\r\n");else n.candidate.candidate.indexOf("typ endOfCandidates")===-1&&(t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n");if(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),!n.candidate&&"complete"!==e.iceGatheringState){var o=e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});o&&(e.iceGatheringState="complete")}}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.getConfiguration=function(){return this._config},window.RTCPeerConnection.prototype.addStream=function(e){var t=e.clone();e.getTracks().forEach(function(e,n){var r=t.getTracks()[n];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),this.localStreams.push(t),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate){i.numChannels=Math.min(e.numChannels,i.numChannels),n.codecs.push(i),i.rtcpFeedback=i.rtcpFeedback.filter(function(t){for(var n=0;n<e.rtcpFeedback.length;n++)if(e.rtcpFeedback[n].type===t.type&&e.rtcpFeedback[n].parameter===t.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions),o=new RTCIceTransport(i);i.onlocalcandidate=function(a){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var c=a.candidate,u=!c||0===Object.keys(c).length;u?(void 0===i.state&&(i.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(c.component="RTCP"===o.component?2:1,s.candidate.candidate=r.writeCandidate(c));var d=r.splitSections(n.localDescription.sdp);s.candidate.candidate.indexOf("typ endOfCandidates")===-1?d[s.candidate.sdpMLineIndex+1]+="a="+s.candidate.candidate+"\r\n":d[s.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",n.localDescription.sdp=d.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":n._localIceCandidatesBuffer.push(s),u&&l&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),n.dispatchEvent(s),null!==n.onicecandidate&&n.onicecandidate(s),l&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete");break;case"complete":}},o.onicestatechange=function(){n._updateConnectionState()};var a=new RTCDtlsTransport(o);return a.ondtlsstatechange=function(){n._updateConnectionState()},a.onerror=function(){a.state="failed",n._updateConnectionState()},{iceGatherer:i,iceTransport:o,dtlsTransport:a}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var i=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:r.localCName},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&("video"===e.kind&&e.recvEncodingParameters&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),i.encodings=e.recvEncodingParameters,i.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,i=this;if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(i.remoteDescription.sdp),n=t.shift();var o=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],s=a.iceGatherer,c=a.iceTransport,u=a.dtlsTransport,d=a.localCapabilities,l=a.remoteCapabilities,f="0"===e.split("\n",1)[0].split(" ",2)[1];if(!f&&!a.isDatachannel){var p=r.getIceParameters(e,n);if(o){var h=r.matchPrefix(e,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});h.length&&c.setRemoteCandidates(h)}var g=r.getDtlsParameters(e,n);o&&(g.role="server"),i.usingBundle&&0!==t||(c.start(s,p,o?"controlling":"controlled"),u.start(g));var m=i._getCommonCapabilities(d,l);i._transceive(a,m.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var a=arguments.length>1&&"function"==typeof arguments[1];if(a){var s=arguments[1];window.setTimeout(function(){s(),"new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),i._emitBufferedCandidates()},0)}var c=Promise.resolve();return c.then(function(){a||("new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),window.setTimeout(i._emitBufferedCandidates.bind(i),500))}),c},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,i=[],o=r.splitSections(e.sdp),a=o.shift(),s=r.matchPrefix(a,"a=ice-lite").length>0;switch(this.usingBundle=r.matchPrefix(a,"a=group:BUNDLE ").length>0,o.forEach(function(o,c){var u=r.splitLines(o),d=u[0].substr(2).split(" "),l=d[0],f="0"===d[1],p=r.getDirection(o,a),h=r.matchPrefix(o,"a=mid:");if(h=h.length?h[0].substr(6):r.generateIdentifier(),"application"===l&&"DTLS/SCTP"===d[2])return void(t.transceivers[c]={mid:h,isDatachannel:!0});var g,m,v,y,w,b,C,E,k,R,S,P,x=r.parseRtpParameters(o);f||(S=r.getIceParameters(o,a),P=r.getDtlsParameters(o,a),P.role="client"),E=r.parseRtpEncodingParameters(o);var T,_=r.matchPrefix(o,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];_&&(T=_.value);var D=r.matchPrefix(o,"a=end-of-candidates",a).length>0,O=r.matchPrefix(o,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==e.type||f)"answer"!==e.type||f||(g=t.transceivers[c],m=g.iceGatherer,v=g.iceTransport,y=g.dtlsTransport,w=g.rtpSender,b=g.rtpReceiver,C=g.sendEncodingParameters,k=g.localCapabilities,t.transceivers[c].recvEncodingParameters=E,t.transceivers[c].remoteCapabilities=x,t.transceivers[c].cname=T,(s||D)&&O.length&&v.setRemoteCandidates(O),t.usingBundle&&0!==c||(v.start(m,S,"controlling"),y.start(P)),t._transceive(g,"sendrecv"===p||"recvonly"===p,"sendrecv"===p||"sendonly"===p),!b||"sendrecv"!==p&&"sendonly"!==p?delete g.rtpReceiver:(R=b.track,i.push([R,b]),n.addTrack(R)));else{var A=t.usingBundle&&c>0?{iceGatherer:t.transceivers[0].iceGatherer,iceTransport:t.transceivers[0].iceTransport,dtlsTransport:t.transceivers[0].dtlsTransport}:t._createIceAndDtlsTransports(h,c);if(D&&A.iceTransport.setRemoteCandidates(O),k=RTCRtpReceiver.getCapabilities(l),k.codecs=k.codecs.filter(function(e){return"rtx"!==e.name}),C=[{ssrc:1001*(2*c+2)}],b=new RTCRtpReceiver(A.dtlsTransport,l),R=b.track,i.push([R,b]),n.addTrack(R),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=c){var L;"audio"===l?L=t.localStreams[0].getAudioTracks()[0]:"video"===l&&(L=t.localStreams[0].getVideoTracks()[0]),L&&(w=new RTCRtpSender(L,A.dtlsTransport))}t.transceivers[c]={iceGatherer:A.iceGatherer,iceTransport:A.iceTransport,dtlsTransport:A.dtlsTransport,localCapabilities:k,remoteCapabilities:x,rtpSender:w,rtpReceiver:b,kind:l,mid:h,cname:T,sendEncodingParameters:C,recvEncodingParameters:E},t._transceive(t.transceivers[c],!1,"sendrecv"===p||"sendonly"===p)}}),this.remoteDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){var e=new Event("addstream");e.stream=n,t.dispatchEvent(e),null!==t.onaddstream&&window.setTimeout(function(){t.onaddstream(e)},0),i.forEach(function(r){var i=r[0],o=r[1],a=new Event("track");a.track=i,a.receiver=o,a.streams=[n],t.dispatchEvent(e),null!==t.ontrack&&window.setTimeout(function(){t.ontrack(a)},0)})},0)),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t=this,n={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,e="new",n.failed>0?e="failed":n.connecting>0||n.checking>0?e="connecting":n.disconnected>0?e="disconnected":n.new>0?e="new":(n.connected>0||n.completed>0)&&(e="connected"),e!==t.iceConnectionState){t.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this.dispatchEvent(r),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(r)}},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var n=[],i=0,o=0;if(this.localStreams.length&&(i=this.localStreams[0].getAudioTracks().length,o=this.localStreams[0].getVideoTracks().length),t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(i=t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(o=t.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?i>0:o>0}),"audio"===e.kind?i--:"video"===e.kind&&o--});i>0||o>0;)i>0&&(n.push({kind:"audio",wantReceive:!0}),i--),o>0&&(n.push({kind:"video",wantReceive:!0}),o--);var a=r.writeSessionBoilerplate(),s=[];n.forEach(function(t,n){var i=t.track,o=t.kind,a=r.generateIdentifier(),c=e.usingBundle&&n>0?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:e._createIceAndDtlsTransports(a,n),u=RTCRtpSender.getCapabilities(o);u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name}),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1")});var d,l,f=[{ssrc:1001*(2*n+1)}];i&&(d=new RTCRtpSender(i,c.dtlsTransport)),t.wantReceive&&(l=new RTCRtpReceiver(c.dtlsTransport,o)),s[n]={iceGatherer:c.iceGatherer,iceTransport:c.iceTransport,dtlsTransport:c.dtlsTransport,
localCapabilities:u,remoteCapabilities:null,rtpSender:d,rtpReceiver:l,kind:o,mid:a,sendEncodingParameters:f,recvEncodingParameters:null}}),this.usingBundle&&(a+="a=group:BUNDLE "+s.map(function(e){return e.mid}).join(" ")+"\r\n"),n.forEach(function(t,n){var i=s[n];a+=r.writeMediaSection(i,i.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=s;var c=new RTCSessionDescription({type:"offer",sdp:a});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,c),Promise.resolve(c)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n){if(n.isDatachannel)return void(t+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+n.mid+"\r\n");var i=e._getCommonCapabilities(n.localCapabilities,n.remoteCapabilities);t+=r.writeMediaSection(n,i,"answer",e.localStreams[0])});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var o=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===o.protocol&&(0===o.port||9===o.port))return;if("1"!==o.component)return;"endOfCandidates"===o.type&&(o={}),i.iceTransport.addRemoteCandidate(o);var a=r.splitSections(this.remoteDescription.sdp);a[t+1]+=(o.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=a.join("")}}else this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r.set(t,e[t]),r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}}};t.exports={shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":10,"./getusermedia":6,sdp:1}],6:[function(e,t,n){t.exports=function(){var e=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return t(n).catch(function(t){return Promise.reject(e(t))})}}},{}],7:[function(e,t,n){var r=e("../utils").browserDetails,i={shimOnTrack:function(){"object"!==("undefined"==typeof window?"undefined":d(window))||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"===("undefined"==typeof window?"undefined":d(window))&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"===("undefined"==typeof window?"undefined":d(window))&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(r.version<38&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;if(RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())},r.version<48){var t=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},n=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,r,i){return n.apply(this,[e||null]).then(function(e){return t(e)}).then(r,i)}}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":10,"./getusermedia":8}],8:[function(e,t,n){var r=e("../utils").log,i=e("../utils").browserDetails;t.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!==("undefined"==typeof e?"undefined":d(e))||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"===d(e[n])?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})},n=function(e){return new Promise(function(n,r){t(e,n,r)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},i.version<41){var o=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return o().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return a(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){return i.version<44?t(e,n,r):(console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(n,r))}}},{"../utils":10}],9:[function(e,t,n){var r={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};t.exports={shimGetUserMedia:r.shimGetUserMedia}},{}],10:[function(e,t,n){var r=!0,i={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+("undefined"==typeof e?"undefined":d(e))+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"===("undefined"==typeof window?"undefined":d(window))){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)}return e}};t.exports={log:i.log,disableLog:i.disableLog,browserDetails:i.detectBrowser(),extractVersion:i.extractVersion}},{}]},{},[2])(2)}),/*!
	  Script: easyrtc.js
	
	    Provides client side support for the EasyRTC framework.
	    See the easyrtc_client_api.md and easyrtc_client_tutorial.md
	    for more details.
	
	  About: License
	
	    Copyright (c) 2016, Priologic Software Inc.
	    All rights reserved.
	
	    Redistribution and use in source and binary forms, with or without
	    modification, are permitted provided that the following conditions are met:
	
	        * Redistributions of source code must retain the above copyright notice,
	          this list of conditions and the following disclaimer.
	        * Redistributions in binary form must reproduce the above copyright
	          notice, this list of conditions and the following disclaimer in the
	          documentation and/or other materials provided with the distribution.
	
	    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
	    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
	    ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
	    LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
	    CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
	    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
	    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
	    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
	    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
	    POSSIBILITY OF SUCH DAMAGE.
	*/
function(e,s){o=[i,a,n(165)],r=s,!(c="function"==typeof r?r.apply(t,o):r)}(void 0,function(e,t,n,r){var i=function(){function i(e,t){se.debugPrinter&&se.debugPrinter(e,t)}function o(e){if(null===e||e===r)return!0;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function a(e){var t,n;for(n=e.getAudioTracks(),t=0;t<n.length;t++)try{n[t].stop()}catch(e){}for(n=e.getVideoTracks(),t=0;t<n.length;t++)try{n[t].stop()}catch(e){}if("function"==typeof e.stop)try{e.stop()}catch(e){}}function s(e){return e&&(e.socket&&e.socket.connected||e.connected)}function c(e,t){if("string"!=typeof e)throw se.showError(se.errCodes.DEVELOPER_ERR,t+" called without a string as the first argument"),"developer error";if(!me[e])throw se.showError(se.errCodes.DEVELOPER_ERR,t+" called with a bad event name = "+e),"developer error"}function u(e,t){navigator.mediaDevices.enumerateDevices().then(function(n){for(var r=[],i=0;i<n.length;i++){var o=n[i];o.kind===t&&(o.id=o.deviceId,r.push(o))}e(r)}).catch(function(e){i("Unable to enumerate devices ("+e+")")})}function l(e,t,n){Ie[e]?Ie[e].pc.getStats?Ie[e].pc.getStats(null,function(r){var i,o={},a={},s=null;if(r&&r.forEach(function(e){var t,n;if(e.type.match(/boundrtp/)){if(e.id.match(/audio/))t=e.type+"_audio";else{if(!e.id.match(/video/))return;t=e.type+"_video"}for(n in e)e.hasOwnProperty(n)&&(o[t+"."+n]=e[n])}else e.hasOwnProperty("ipAddress")&&e.id?a[e.id]=e.ipAddress+":"+e.portNumber:e.hasOwnProperty("selected")&&e.hasOwnProperty("remoteCandidateId")&&e.selected&&(s=e.remoteCandidateId)}),s&&(o.firefoxRemoteAddress=a[s]),n){var c={};for(i in n)n.hasOwnProperty(i)&&o.hasOwnProperty(i)&&(c[n[i]]=o[i]);t(e,c)}else t(e,o)},function(e){i("unable to get statistics")}):t(e,{statistics:se.getConstantString("statsNotSupported")}):t(e,{connected:!1})}function f(e,t,n){Ie[e]?Ie[e].pc.getStats?Ie[e].pc.getStats(function(r){var i,o,a,s,c,u,d,l,f,p,h,g,m,v={},y=r.result(),w=[],b=0,C=null;if(n){for(o=0;o<y.length;o++){for(w[o]={},u=y[o].names(),a=0;a<u.length;a++)w[o][u[a]]=!0;w[o].googRemoteAddress&&w[o].googActiveConnection&&(p=y[o].stat("googActiveConnection"),p!==!0&&"true"!==p||(h=parseInt(y[o].stat("bytesReceived"))+parseInt(y[o].stat("bytesSent")),h>b&&(f=o,b=h)))}for(o=0;o<y.length;o++)w[o].googActiveConnection&&(o!==f?w[o]={}:(g=y[o].stat("googLocalAddress").split(":")[0],m=y[o].stat("googRemoteAddress").split(":")[0],se.isTurnServer(g)?C=g:se.isTurnServer(m)&&(C=m)));for(o=0;o<n.length;o++){for(s=n[o],l=[],i=null,a=0;a<y.length;a++){var E=!0;for(c in s)if(s.hasOwnProperty(c)&&!w[a][c]){E=!1;break}E&&y[a]&&l.push(y[a])}if(1===l.length){for(a=0;a<l.length;a++)if(i=l[a])for(c in s)s.hasOwnProperty(c)&&(d=s[c],v[d]=i.stat(c))}else if(l.length>1){for(c in s)s.hasOwnProperty(c)&&(v[s[c]]=[]);for(a=0;a<l.length;a++){i=l[a];for(c in s)s.hasOwnProperty(c)&&(d=s[c],v[d].push(i.stat(c)))}}}}else for(o=0;o<y.length;o++)for(u=y[o].names(),a=0;a<u.length;a++)c=u[a],v[y[o].id+"."+c]=y[o].stat(c);v.remoteAddress&&C&&(v.remoteAddress=C),t(e,v)}):t(e,{statistics:se.getConstantString("statsNotSupported")}):t(e,{connected:!1})}function p(e,t){var n=JSON.stringify(t);JSON.parse(n);var r={msgType:"setRoomApiField",msgData:{setRoomApiField:{roomName:e,field:t}}};se.webSocket.json.emit("easyrtcCmd",r,function(e){"error"===e.msgType&&se.showError(e.msgData.errorCode,e.msgData.errorText)})}function h(e){je&&clearTimeout(je),je=setTimeout(function(){p(e,se._roomApiFields[e]),je=null},10)}function g(e,t){var n;if(t)for(n=0;n<t.length;n++){var r=t[n];r.enabled=e}}function m(e){return e||(e="default"),ye.hasOwnProperty(e)?ye[e]:null}function v(){var e,t={};for(e in ye)ye.hasOwnProperty(e)&&(t[e]=ye[e].id||"default");return t}function y(e,t){var n;if(t||(t="default"),e.streamName=t,ye[t]=e,"default"!==t){var r=v(),i=se.roomData;for(n in i)i.hasOwnProperty(n)&&se.setRoomApiField(n,"mediaIds",r)}}function w(e,n){var i,o,a;if(n||(n="default"),Ie[e]&&(a=Ie[e].remoteStreamIdToName[n]))return a;for(i in se.roomData)if(se.roomData.hasOwnProperty(i)){if(o=se.getRoomApiField(i,e,"mediaIds"),!o)continue;for(a in o)if(o.hasOwnProperty(a)&&o[a]===n)return a;if(t&&t.browserDetails&&"firefox"===t.browserDetails.browser){if(o.default)return"default";for(var s in o)if(o.hasOwnProperty(s))return s}}return r}function b(e){e||(e="default");var t=se.getLocalStream(e);if(t){var n,r,i=t.id||"default";if(ye[e]){for(n in Ie)if(Ie.hasOwnProperty(n)){try{Ie[n].pc.removeStream(t)}catch(e){}se.sendPeerMessage(n,"__closingMediaStream",{streamId:i,streamName:e})}if(a(ye[e]),delete ye[e],"default"!==e){var o=v();for(r in se.roomData)se.roomData.hasOwnProperty(r)&&se.setRoomApiField(r,"mediaIds",o)}}}}function C(e,t,n){var r=null,i=e.pc.getRemoteStreams();if(n||(n="default"),"default"===n)return i.length>0?i[0]:null;for(var o in se.roomData)if(se.roomData.hasOwnProperty(o)){var a=se.getRoomApiField(o,t,"mediaIds");if(r=a?a[n]:null)break}r||se.showError(se.errCodes.DEVELOPER_ERR,"remote peer does not have media stream called "+n);for(var s=0;s<i.length;s++){var c;if(c=i[s].id?i[s].id:"default",!r||c===r||0===c.indexOf(r))return i[s]}return null}function E(e,t,n){var r,i;if(e){if(i=Ie[e],!i)return se.showError(se.errCodes.DEVELOPER_ERR,"haveTracks called about a peer you don't have a connection to"),!1;r=C(Ie[e],e,n)}else r=m(n);if(!r)return!1;var o;try{o=t?r.getAudioTracks():r.getVideoTracks()}catch(e){return!0}return!!o&&o.length>0}function k(){var e;if(se.loggingOut=!0,ke={},Ne={},se.disconnecting=!0,Je=se.webSocket,se.webSocketConnected&&(ze||se.webSocket.close(),se.webSocketConnected=!1),se.hangupAll(),xe)for(e in De)De.hasOwnProperty(e)&&xe(e,{},!1);De={},se.emitEvent("roomOccupant",{}),se.roomData={},se.roomJoin={},se._roomApiFields={},se.loggingOut=!1,se.myEasyrtcid=null,se.disconnecting=!1,Ee={}}function R(e,t,n,r,o){if(!se.webSocket)throw"Attempt to send message without a valid connection to the server.";var a={msgType:t};e&&(a.targetEasyrtcid=e),n&&(a.msgData=n),i("sending socket message "+JSON.stringify(a)),se.webSocket.json.emit("easyrtcCmd",a,function(e){"error"!==e.msgType?(e.hasOwnProperty("msgData")||(e.msgData=null),r&&r(e.msgType,e.msgData)):o?o(e.msgData.errorCode,e.msgData.errorText):se.showError(e.msgData.errorCode,e.msgData.errorText)})}function S(e,t){var n,r,i,o,a,s=e+"-"+Ge++,c=Math.ceil(t.length/se.maxP2PMessageLength);for(i={transfer:"start",transferId:s,parts:c},a={transfer:"end",transferId:s},Ie[e].dataChannelS.send(JSON.stringify(i)),n=0,r=t.length;n<r;n+=se.maxP2PMessageLength)o={transferId:s,data:t.substr(n,se.maxP2PMessageLength),transfer:"chunk"},Ie[e].dataChannelS.send(JSON.stringify(o));Ie[e].dataChannelS.send(JSON.stringify(a))}function P(){var e=[];return e.push({DtlsSrtpKeyAgreement:"true"}),{optional:e}}function x(e,t,n){var r;for(r=0;r<Ie[e].candidatesToSend.length;r++)R(e,"candidate",Ie[e].candidatesToSend[r],t,n)}function T(e,t){if(Ie[e]){var n,r;r=t.id?t.id:"default",n=Ie[e].remoteStreamIdToName[r]||"default",Ie[e].liveRemoteStreams[n]&&se.onStreamClosed&&(delete Ie[e].liveRemoteStreams[n],se.onStreamClosed(e,t,n)),delete Ie[e].remoteStreamIdToName[r]}}function _(e,t){if(Ie[e]&&(T(e,t),Le(),Ie[e].pc))try{Ie[e].pc.removeStream(t)}catch(e){}}function D(e,t){function n(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}var r={};return n(e)&&(r.added=e),n(t)&&(r.deleted=t),n(r)?r:null}function O(e,t){var n,r,i={},o={};for(n in t)t.hasOwnProperty(n)&&(null===e||"undefined"==typeof e[n]?i[n]=t[n]:"object"===d(t[n])?(r=O(e[n],t[n]),null!==r&&(i[n]=t[n])):t[n]!==e[n]&&(i[n]=t[n]));for(n in e)t.hasOwnProperty(n)&&"undefined"==typeof t[n]&&(o[n]=e[n]);return D(i,o)}function A(){var e,t={};for(e in Ie)Ie.hasOwnProperty(e)&&(t[e]={connectTime:Ie[e].connectTime,isInitiator:!!Ie[e].isInitiator});var n={userSettings:{sharingAudio:!!ge.audio,sharingVideo:!!ge.video,sharingData:!!Se,nativeVideoWidth:se.nativeVideoWidth,nativeVideoHeight:se.nativeVideoHeight,windowWidth:window.innerWidth,windowHeight:window.innerHeight,screenWidth:window.screen.width,screenHeight:window.screen.height,cookieEnabled:navigator.cookieEnabled,os:navigator.oscpu,language:navigator.language}};return o(t)||(n.p2pList=t),n}function L(){var e=A(!1),t=function(){var t=O(Ee,e);t&&(i("cfg="+JSON.stringify(t.added)),se.webSocket&&R(null,"setUserCfg",{setUserCfg:t.added},null,null)),Ee=e};Ee==={}?t():setTimeout(t,100)}function I(e){var t="";return t+=e>>24,t+=" | ",t+=e>>8&65535,t+=" | ",t+=255&e}function N(e){var t="candidate:",n=e.indexOf(t)+t.length,r=e.substr(n).split(" ");return{component:r[1],type:r[7],foundation:r[0],protocol:r[2],address:r[4],port:r[5],priority:I(r[3])}}function M(e){se._candicates=se._candicates||[],se._candicates.push(N(e))}function B(e,t){if(Ie[e]&&!Ie[e].cancelled){var n=Ie[e];n.startedAV||(n.startedAV=!0,n.sharingAudio=ge.audio,n.sharingVideo=ge.video,n.connectTime=(new Date).getTime(),n.callSuccessCB&&(n.sharingAudio||n.sharingVideo)&&n.callSuccessCB(e,"audiovideo"),(se.audioEnabled||se.videoEnabled)&&L());var r=w(e,t.id||"default");r||(r="default"),n.remoteStreamIdToName[t.id||"default"]=r,n.liveRemoteStreams[r]=!0,t.streamName=r,se.streamAcceptor&&(se.streamAcceptor(e,t,r),se.sendDataWS(e,"easyrtc_streamReceived",{streamName:r},function(){}))}}function j(e,t){if(Ie[e]&&!Ie[e].cancelled){var n=Ie[e];n.trackTimers=n.trackTimers||{};for(var r=0,i=t.length;r<i;r++){var o=t[r],a=o.id||"default";clearTimeout(n.trackTimers[a]),n.trackTimers[a]=setTimeout(function(t){B(n,e,t)}.bind(o),100)}}}function U(e,t,n,r){function o(t){if(i("saw dataChannel.onmessage event: ",t.data),"dataChannelPrimed"===t.data)se.sendDataWS(e,"dataChannelPrimed","");else{var n;try{n=JSON.parse(t.data)}catch(e){i("Developer error, unable to parse event data")}if(n)if(n.transfer&&n.transferId)if("start"===n.transfer){i("start transfer #"+n.transferId);var r=parseInt(n.parts);g={chunks:[],parts:r,transferId:n.transferId}}else if("chunk"===n.transfer)i("got chunk for transfer #"+n.transferId),"string"==typeof n.data&&n.data.length<=se.maxP2PMessageLength?g?n.transferId!==g.transferId?i("Developer error, invalid transfer id"):g.chunks.length+1>g.parts?i("Developer error, received too many chunks"):g.chunks.push(n.data):i("Developer error, unexpected chunk"):i("Developer error, invalid data");else if("end"===n.transfer){if(i("end of transfer #"+n.transferId),g)if(n.transferId!==g.transferId)i("Developer error, invalid transfer id");else if(g.chunks.length!==g.parts)i("Developer error, received wrong number of chunks");else{var o;try{o=JSON.parse(g.chunks.join(""))}catch(e){i("Developer error, unable to parse message")}o&&se.receivePeerDistribute(e,o,null)}else i("Developer error, unexpected end of transfer");g={}}else i("Developer error, got an unknown transfer message"+n.transfer);else se.receivePeerDistribute(e,n,null)}}function a(e){i("saw initOutgoingChannel call");var t=u.createDataChannel(Ce,se.getDatachannelConstraints());Ie[e].dataChannelS=t,Ie[e].dataChannelR=t,t.onmessage=o,t.onopen=function(n){i("saw dataChannel.onopen event"),Ie[e]&&t.send("dataChannelPrimed")},t.onclose=function(t){i("saw dataChannelS.onclose event"),Ie[e]&&(Ie[e].dataChannelReady=!1,delete Ie[e].dataChannelS),_e&&_e(e),Le()}}function s(e){i("initializing incoming channel handler for "+e),Ie[e].pc.ondatachannel=function(t){i("saw incoming data channel");var n=t.channel;Ie[e].dataChannelR=n,Ie[e].dataChannelS=n,Ie[e].dataChannelReady=!0,n.onmessage=o,n.onclose=function(t){i("saw dataChannelR.onclose event"),Ie[e]&&(Ie[e].dataChannelReady=!1,delete Ie[e].dataChannelR),_e&&_e(e),Le()},n.onopen=function(t){i("saw dataChannel.onopen event"),Ie[e]&&n.send("dataChannelPrimed")}}}var u,d,l,f=Ve?Ve:Ue;i("building peer connection to "+e);try{if(u=se.createRTCPeerConnection(f,P()),!u)throw d="Unable to create PeerConnection object, check your ice configuration("+JSON.stringify(f)+")",i(d),Error(d);Se&&"undefined"==typeof u.createDataChannel&&(Se=!1),u.onnegotiationneeded=function(t){Ie[e]&&Ie[e].enableNegotiateListener&&u.createOffer(function(t){ue&&(t.sdp=ue(t.sdp)),u.setLocalDescription(t,function(){se.sendPeerMessage(e,"__addedMediaStream",{sdp:t})},function(){})},function(e){i("unexpected error in creating offer")})},u.onsignalingstatechange=function(){var t=c.currentTarget||c.target||u,n=t.signalingState||"unknown";pe&&pe(e,t,n)},u.oniceconnectionstatechange=function(t){var r=t.currentTarget||t.target||u,i=r.iceConnectionState||"unknown";switch(fe&&fe(e,r,i),i){case"connected":se.onPeerOpen&&se.onPeerOpen(e),Ie[e]&&Ie[e].callSuccessCB&&Ie[e].callSuccessCB(e,"connection");break;case"failed":n&&n(se.errCodes.NOVIABLEICE,"No usable STUN/TURN path"),delete Ie[e];break;case"disconnected":se.onPeerFailing&&se.onPeerFailing(e),Ie[e]&&(Ie[e].failing=Date.now());break;case"closed":se.onPeerClosed&&se.onPeerClosed(e);break;case"completed":Ie[e]&&(Ie[e].failing&&se.onPeerRecovered&&se.onPeerRecovered(e,Ie[e].failing,Date.now()),delete Ie[e].failing)}},u.onconnection=function(){i("onconnection called prematurely")},l={pc:u,candidatesToSend:[],startedAV:!1,connectionAccepted:!1,isInitiator:t,remoteStreamIdToName:{},streamsAddedAcks:{},liveRemoteStreams:{}},u.onicecandidate=function(t){if(!Ie[e]||!Ie[e].cancelled){var r;if(t.candidate&&Ie[e]){if(r={type:"candidate",label:t.candidate.sdpMLineIndex,id:t.candidate.sdpMid,candidate:t.candidate.candidate},le&&(r=le(r,!1),!r))return;M(t.candidate.candidate),Ie[e].connectionAccepted?R(e,"candidate",r,null,function(){n(se.errCodes.PEER_GONE,"Candidate disappeared")}):Ie[e].candidatesToSend.push(r)}}},u.ontrack=function(t){i("empty ontrack method invoked, which is expected"),j(e,t.streams)},u.onaddstream=function(t){i("empty onaddstream method invoked, which is expected"),B(e,t.stream)},u.onremovestream=function(t){i("saw remove on remote media stream"),_(e,t.stream)},Ie[e]=l}catch(e){return i("buildPeerConnection error",e),n(se.errCodes.SYSTEM_ERR,e.message),null}var p,h;if(r)for(p=0;p<r.length;p++)h=m(r[p]),h?u.addStream(h):i("Developer error, attempt to access unknown local media stream "+r[p]);else ce&&(se.videoEnabled||se.audioEnabled)&&(h=se.getLocalStream(),u.addStream(h));var g={};if(Se){if(se.setPeerListener(function(){Ie[e]?(Ie[e].dataChannelReady=!0,Ie[e].callSuccessCB&&Ie[e].callSuccessCB(e,"datachannel"),Te&&Te(e,!0),Le()):i("failed to setup outgoing channel listener")},"dataChannelPrimed",e),t)try{a(e)}catch(e){i("failed to init outgoing channel"),n(se.errCodes.SYSTEM_ERR,se.formatError(e))}t||s(e)}return u.onconnection=function(){i("setup pc.onconnection ")},se.setPeerListener(function(e,t,n,r){l.streamsAddedAcks[n.streamName]&&(l.streamsAddedAcks[n.streamName](e,n.streamName),delete l.streamsAddedAcks[n.streamName])},"easyrtc_streamReceived",e),u}function V(e,t,n){var r=U(e,!1,function(e){se.showError(se.errCodes.SYSTEM_ERR,e)},n),o=Ie[e];if(!r)return void i("buildPeerConnection failed. Call not answered");var a=function(t){if(!o.cancelled){var n=function(){function n(){i("sending success")}function o(t,n){i("sending error"),delete Ie[e],se.showError(t,n)}i("sending answer"),R(e,"answer",t,n,o),Ie[e].connectionAccepted=!0,x(e,n,o),r.connectDataConnection&&(i("calling connectDataConnection(5002,5001)"),r.connectDataConnection(5002,5001))};ue&&(t.sdp=ue(t.sdp)),r.setLocalDescription(t,n,function(e){se.showError(se.errCodes.INTERNAL_ERR,"setLocalDescription: "+e)})}},s=new RTCSessionDescription(t);if(!s)throw"Could not create the RTCSessionDescription";i("sdp ||  "+JSON.stringify(s));var c=function(){o.cancelled||r.createAnswer(a,function(e){se.showError(se.errCodes.INTERNAL_ERR,"create-answer: "+e)},be)};i("about to call setRemoteDescription in doAnswer");try{de&&(s.sdp=de(s.sdp)),r.setRemoteDescription(s,c,function(e){se.showError(se.errCodes.INTERNAL_ERR,"set-remote-description: "+e)})}catch(e){i("set remote description failed"),se.showError(se.errCodes.INTERNAL_ERR,"setRemoteDescription failed: "+e.message)}}function F(e,t,n){if(!n&&ce){var r=se.getLocalStream();if(!r&&(se.videoEnabled||se.audioEnabled))return void se.initMediaSource(function(){F(e,t)},function(e,t){se.showError(se.errCodes.MEDIA_ERR,se.format(se.getConstantString("localMediaError")))})}Fe?se.getFreshIceConfig(function(r){r?V(e,t,n):se.showError(se.errCodes.CALL_ERR,"Failed to get fresh ice config")}):V(e,t,n)}function q(e,t,n,r,o){Ne[e]=!0;var a,s=U(e,!0,n,o);if(!s)throw a="buildPeerConnection failed, call not completed",i(a),a;Ie[e].callSuccessCB=t,Ie[e].callFailureCB=n,Ie[e].wasAcceptedCB=r;var c=Ie[e],u=function(t){if(!c.cancelled){var r=function(){R(e,"offer",t,null,n)};ue&&(t.sdp=ue(t.sdp)),s.setLocalDescription(t,r,function(e){n(se.errCodes.CALL_ERR,e)})}};setTimeout(function(){Ie[e]&&s.createOffer(u,function(e){n(se.errCodes.CALL_ERR,JSON.stringify(e))},be)},100)}function z(e){var t;return t=e.active===!0||e.ended===!1||e.getTracks().reduce(function(e){return e.enabled})}function J(e){He[e]={candidates:[]}}function G(e){if(Ne[e]&&delete Ne[e],ke[e]&&delete ke[e],!Ie[e].cancelled&&Ie[e].pc)try{for(var t=Ie[e].pc.getRemoteStreams(),n=0;n<t.length;n++)z(t[n])&&(T(e,t[n]),a(t[n]));Ie[e].pc.close(),Ie[e].cancelled=!0,i("peer closed")}catch(t){i("peer "+e+" close failed:"+t)}finally{se.onPeerClosed&&se.onPeerClosed(e)}}function H(e){i("Hanging up on "+e),J(e),Ie[e]&&(Ie[e].pc&&G(e),Ie[e]&&delete Ie[e],Le(),se.webSocket&&R(e,"hangup",null,function(){i("hangup succeeds")},function(e,t){i("hangup failed:"+t),se.showError(e,t)}))}function W(e){i("Saw onRemote hangup event"),J(e),Ie[e]?(Ie[e].pc?G(e):se.callCancelled&&se.callCancelled(e,!0),Ie[e]&&delete Ie[e]):se.callCancelled&&se.callCancelled(e,!0)}function X(e){var t;for(t in De)if(De.hasOwnProperty(t)&&De[t][e])return!0;return!1}function Y(e){var t;for(t in Ie)Ie.hasOwnProperty(t)&&"undefined"==typeof e[t]&&(X(t)||((Ie[t].pc||Ie[t].isInitiator)&&W(t),delete ke[t],delete Ne[t],J(t)));for(t in ke)ke.hasOwnProperty(t)&&!X(t)&&(W(t),J(t),delete ke[t],delete Ne[t]);for(t in Ne)Ne.hasOwnProperty(t)&&!X(t)&&(W(t),J(t),delete Ne[t])}function $(e,t,n){n||(n=100);var r=0;We[e]&&(clearTimeout(We[e].timer),r=We[e].counter),r>20?(delete We[e],t()):(We[e]={counter:r+1},We[e].timer=setTimeout(function(){delete We[e],t()},n))}function K(e,t){var n,r=null,i={};for(n in t)t.hasOwnProperty(n)&&(n===se.myEasyrtcid?r=t[n]:i[n]=t[n]);Y(i),$("roomOccupants&"+e,function(){xe&&xe(e,i,r),se.emitEvent("roomOccupants",{roomName:e,occupants:De})},100)}function Q(e,t){var n={};t&&t(se.ackMessage),e.targetEasyrtcid&&(n.targetEasyrtcid=e.targetEasyrtcid),e.targetRoom&&(n.targetRoom=e.targetRoom),e.targetGroup&&(n.targetGroup=e.targetGroup),e.senderEasyrtcid?se.receivePeerDistribute(e.senderEasyrtcid,e,n):Ae?Ae(e.msgType,e.msgData,n):i("Unhandled server message "+JSON.stringify(e))}function Z(e){var t;0===e.indexOf("turn:")||0===e.indexOf("turns:")?(t=e.split(/[@:&]/g)[1],se._turnServers[t]=!0):0!==e.indexOf("stun:")&&0!==e.indexOf("stuns:")||(t=e.split(/[@:&]/g)[1],se._stunServers[t]=!0)}function ee(e){var t,n,r;for(Ue={iceServers:[]},se._turnServers={},se._stunServers={},e&&e.iceServers&&"undefined"!=typeof e.iceServers.length?Ue={iceServers:e.iceServers}:se.showError(se.errCodes.DEVELOPER_ERR,"iceConfig received from server didn't have an array called iceServers, ignoring it"),t=0;t<e.iceServers.length;t++)if(r=e.iceServers[t],r.urls&&r.urls.length)for(n=0;n<r.urls.length;n++)Z(r.urls[n]);else r.url&&Z(r.url)}function te(e){e&&(e.easyrtcsid&&(se.easyrtcsid=e.easyrtcsid),e.field&&(we=e.field))}function ne(e){se.roomData=e;var t,n,r,i,o,a;for(n in se.roomData)if(se.roomData.hasOwnProperty(n)){if("join"===e[n].roomStatus){se.roomJoin[n]||(se.roomJoin[n]=e[n]);var s=v();s!=={}&&se.setRoomApiField(n,"mediaIds",s)}else if("leave"===e[n].roomStatus){se.roomEntryListener&&se.roomEntryListener(!1,n),delete se.roomJoin[n],delete De[n];continue}if(e[n].clientList)De[n]=e[n].clientList;else if(e[n].clientListDelta){if(i=e[n].clientListDelta.updateClient)for(o in i)if(i.hasOwnProperty(o)){De[n]||(De[n]=[]),De[n][o]||(De[n][o]=i[o]);for(t in i[o])"apiField"!==t&&"presence"!==t||(De[n][o][t]=i[o][t])}if(r=e[n].clientListDelta.removeClient,r&&De[n])for(a in r)r.hasOwnProperty(a)&&delete De[n][a]}se.roomJoin[n]&&e[n].field&&(qe.rooms[n]=e[n].field),"join"===e[n].roomStatus&&se.roomEntryListener&&se.roomEntryListener(!0,n),K(n,De[n])}se.emitEvent("roomOccupant",De)}function re(e,t){function n(e){delete Ne[e],He[e]&&delete He[e],Ie[e]&&(Ie[e].wasAcceptedCB&&Ie[e].wasAcceptedCB(!1,e),delete Ie[e])}function o(e,t){if(delete Ne[e],Ie[e]){Ie[e].connectionAccepted=!0,Ie[e].wasAcceptedCB&&Ie[e].wasAcceptedCB(!0,e);var n=function(){},r=function(t,n){Ie[e]&&delete Ie[e],se.showError(t,n)};x(e,n,r),s=Ie[e].pc;var o=new RTCSessionDescription(t);if(!o)throw"Could not create the RTCSessionDescription";i("about to call initiating setRemoteDescription");try{de&&(o.sdp=de(o.sdp)),s.setRemoteDescription(o,function(){s.connectDataConnection&&(i("calling connectDataConnection(5001,5002)"),s.connectDataConnection(5001,5002))},function(e){i("setRemoteDescription failed ",e)})}catch(e){i("setRemoteDescription failed ",e)}f(e)}}function a(e,t){Ie[e]&&Ie[e].pc?l(e,t):(Ie[e]||(He[e]={candidates:[]}),He[e].candidates.push(t))}var s,c=e.senderEasyrtcid,u=e.msgType,d=e.msgData;i("received message of type "+u),"undefined"==typeof He[c]&&J(c);var l=function(e,t){function n(){i("iceAddSuccess: "+JSON.stringify(o)),M(t.candidate)}function r(e){se.showError(se.errCodes.ICECANDIDATE_ERR,"bad ice candidate ("+e.name+"): "+JSON.stringify(o))}var o=null;le&&!(t=le(t,!0))||(o=new RTCIceCandidate({sdpMLineIndex:t.label,candidate:t.candidate}),s=Ie[e].pc,s.addIceCandidate(o,n,r))},f=function(e){var t;if(He[e]){for(t=0;t<He[e].candidates.length;t++)l(e,He[e].candidates[t]);delete He[e]}},p=function(e,t){var n=function(n,o){if(o)if("string"==typeof o)o=[o];else if(o.length===r)return void se.showError(se.errCodes.DEVELOPER_ERR,"accept callback passed invalid streamNames");if(i("offer accept="+n),delete ke[e],n){if(!se.supportsPeerConnections())return void se.showError(se.errCodes.CALL_ERR,se.getConstantString("noWebrtcSupport"));F(e,t,o),f(e)}else R(e,"reject",null,null,null),J(e)};return Ne[e]&&e<se.myEasyrtcid?(delete Ne[e],He[e]&&delete He[e],Ie[e]&&(Ie[e].wasAcceptedCB&&Ie[e].wasAcceptedCB(!0,e),delete Ie[e]),void n(!0)):(ke[e]=t,void(se.acceptCheck?se.acceptCheck(e,n):n(!0)))};switch(u){case"sessionData":te(d.sessionData);break;case"roomData":ne(d.roomData);break;case"iceConfig":ee(d.iceConfig);break;case"forwardToUrl":d.newWindow?window.open(d.forwardToUrl.url):window.location.href=d.forwardToUrl.url;break;case"offer":p(c,d);break;case"reject":n(c);break;case"answer":o(c,d);break;case"candidate":a(c,d);break;case"hangup":W(c),J(c);break;case"error":se.showError(d.errorCode,d.errorText);break;default:return void se.showError(se.errCodes.DEVELOPER_ERR,"received unknown message type from server, msgType is "+u)}t&&t(se.ackMessage)}function ie(e){var t=e.msgData;i("entered process token"),t.easyrtcid&&(se.myEasyrtcid=t.easyrtcid),t.field&&(qe.connection=t.field),t.iceConfig&&ee(t.iceConfig),t.sessionData&&te(t.sessionData),t.roomData&&ne(t.roomData),t.application.field&&(qe.application=t.application.field)}function oe(e,t){var n,r,i,a=null;if(se.cookieId&&document.cookie)for(n=document.cookie.split(/[; ]/g),r=se.cookieId+"=",i=0;i<n.length;i++)0===n[i].indexOf(r)&&(a=n[i].substring(r.length));var s={apiVersion:se.apiVersion,applicationName:se.applicationName,setUserCfg:A(!0)};se.roomJoin||(se.roomJoin={}),se.presenceShow&&(s.setPresence={show:se.presenceShow,status:se.presenceStatus}),se.username&&(s.username=se.username),se.roomJoin&&!o(se.roomJoin)&&(s.roomJoin=se.roomJoin),a&&(s.easyrtcsid=a),Re&&(s.credential=Re),se.webSocket.json.emit("easyrtcAuth",{msgType:"authenticate",msgData:s},function(n){var r;if("error"===n.msgType)t(n.msgData.errorCode,n.msgData.errorText),se.roomJoin={};else{if(ie(n),se._roomApiFields)for(r in se._roomApiFields)se._roomApiFields.hasOwnProperty(r)&&h(r);e&&e(se.myEasyrtcid)}})}function ae(e,t){function r(e,t){se.webSocket.on(e,t),se.websocketListeners.push({event:e,handler:t})}function o(n){se.webSocketConnected=!0,se.webSocket||se.showError(se.errCodes.CONNECT_ERR,se.getConstantString("badsocket")),i("saw socket-server onconnect event"),se.webSocketConnected?oe(e,t):t(se.errCodes.SIGNAL_ERR,se.getConstantString("icf"))}var a;if(ze)se.webSocket=ze;else if(se.webSocket)for(a in se.websocketListeners)se.websocketListeners.hasOwnProperty(a)&&se.webSocket.removeEventListener(se.websocketListeners[a].event,se.websocketListeners[a].handler);else try{if(se.webSocket=n.connect(Pe,he),!se.webSocket)throw"io.connect failed"}catch(e){return se.webSocket=0,void t(se.errCodes.SYSTEM_ERROR,e.toString())}se.websocketListeners=[],r("close",function(e){i("the web socket closed")}),r("error",function(e){function n(){se.myEasyrtcid&&s(se.webSocket)?se.showError(se.errCodes.SIGNAL_ERR,se.getConstantString("miscSignalError")):t(se.errCodes.CONNECT_ERR,se.getConstantString("noServer"))}n()}),s(ze)?o(null):r("connect",o),r("easyrtcMsg",Q),r("easyrtcCmd",re),r("disconnect",function(){se.webSocketConnected=!1,Le=function(){},Ee={},k(),se.disconnectListener&&se.disconnectListener()})}var se=this,ce=!0,ue=null,de=null,le=null,fe=null,pe=null,he={"connect timeout":1e4,"force new connection":!0};this.setSdpFilters=function(e,t){ue=e,de=t},this.setPeerClosedListener=function(e){this.onPeerClosed=e},this.setPeerOpenListener=function(e){this.onPeerOpen=e},this.setPeerFailingListener=function(e,t){this.onPeerFailing=e,this.onPeerRecovered=t},this.setIceCandidateFilter=function(e){le=e},this.setIceConnectionStateChangeListener=function(e){fe=e},this.setSignalingStateChangeListener=function(e){pe=e},this.setAutoInitUserMedia=function(e){ce=!!e},this.format=function(e,t,n,r){for(var i=arguments[0],o=1;o<arguments.length;o++){var a=new RegExp("\\{"+(o-1)+"\\}","gi");i=i.replace(a,arguments[o])}return i};var ge={audio:!1,video:!1};this.getConstantString=function(t){return e[t]?e[t]:(se.showError(se.errCodes.DEVELOPER_ERR,"Could not find key='"+t+"' in easyrtc_lang"),t)};var me={roomOccupant:!0,roomOccupants:!0},ve={};this.addEventListener=function(e,t){if(c(e,"addEventListener"),"function"!=typeof t)throw se.showError(se.errCodes.DEVELOPER_ERR,"addEventListener called with a non-function for second argument"),"developer error";se.removeEventListener(e,t),ve[e]||(ve[e]=[]),ve[e][ve[e].length]=t},this.removeEventListener=function(e,t){c(e,"removeEventListener");var n=ve[e],r=0;if(n)for(r=0;r<n.length;r++)n[r]===t&&(r<n.length-1&&(n[r]=n[n.length-1]),n.length=n.length-1)},this.emitEvent=function(e,t){c(e,"emitEvent");var n=ve[e],r=0;if(n)for(r=0;r<n.length;r++)n[r](e,t)},this.errCodes={BAD_NAME:"BAD_NAME",CALL_ERR:"CALL_ERR",DEVELOPER_ERR:"DEVELOPER_ERR",SYSTEM_ERR:"SYSTEM_ERR",CONNECT_ERR:"CONNECT_ERR",MEDIA_ERR:"MEDIA_ERR",MEDIA_WARNING:"MEDIA_WARNING",INTERNAL_ERR:"INTERNAL_ERR",PEER_GONE:"PEER_GONE",ALREADY_CONNECTED:"ALREADY_CONNECTED",BAD_CREDENTIAL:"BAD_CREDENTIAL",ICECANDIDATE_ERR:"ICECANDIDATE_ERR",NOVIABLEICE:"NOVIABLEICE",SIGNAL_ERR:"SIGNAL_ERR"},this.apiVersion="1.1.0",this.ackMessage={msgType:"ack"},this.usernameRegExp=/^(.){1,64}$/,this.cookieId="easyrtcsid";this.loggingOut=!1,this.disconnecting=!1;var ye={},we=[],be={};this.enableAudioReceive=function(e){t&&t.browserDetails&&("firefox"===t.browserDetails.browser||"edge"===t.browserDetails.browser)?be.offerToReceiveAudio=e:(be.mandatory=be.mandatory||{},be.mandatory.OfferToReceiveAudio=e)},this.enableVideoReceive=function(e){t&&t.browserDetails&&("firefox"===t.browserDetails.browser||"edge"===t.browserDetails.browser)?be.offerToReceiveVideo=e:(be.mandatory=be.mandatory||{},be.mandatory.OfferToReceiveVideo=e)},this.enableAudioReceive(!0),this.enableVideoReceive(!0),this.setAudioOutput=function(e,t){"undefined"!=typeof e.sinkId?e.setSinkId(t).then(function(){i("Success, audio output device attached: "+t+" to element with "+e.title+" as source.")}).catch(function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: "+e),i(t)}):i("Browser does not support output device selection.")},this.getAudioSinkList=function(e){u(e,"audiooutput")},this.getAudioSourceList=function(e){u(e,"audioinput")},this.getVideoSourceList=function(e){u(e,"videoinput")};var Ce="dc",Ee={},ke={},Re=null;se.audioEnabled=!0,se.videoEnabled=!0,this.debugPrinter=null,this.myEasyrtcid="",this.nativeVideoHeight=0,this.maxP2PMessageLength=1e3,this.nativeVideoWidth=0,this.roomJoin={},this.isNameValid=function(e){return se.usernameRegExp.test(e)},this.setCookieId=function(e){se.cookieId=e},this._desiredVideoProperties={},this.setVideoSource=function(e){se._desiredVideoProperties.videoSrcId=e,delete se._desiredVideoProperties.screenCapture},this._desiredAudioProperties={},this.setAudioSource=function(e){se._desiredAudioProperties.audioSrcId=e},this.setVideoDims=function(e,t,n){se._desiredVideoProperties.width=e,se._desiredVideoProperties.height=t,n!==r&&(se._desiredVideoProperties.frameRate=n)},this.setScreenCapture=function(e){se._desiredVideoProperties.screenCapture=e!==!1},se.getUserMediaConstraints=function(){var e={};return se._presetMediaConstraints?(e=se._presetMediaConstraints,delete se._presetMediaConstraints,e):se._desiredVideoProperties.screenCapture?{video:{mandatory:{chromeMediaSource:"screen",maxWidth:screen.width,maxHeight:screen.height,minWidth:screen.width,minHeight:screen.height,minFrameRate:1,maxFrameRate:5},optional:[]},audio:!1}:(se.videoEnabled?t&&t.browserDetails&&("firefox"===t.browserDetails.browser||"edge"===t.browserDetails.browser)?(e.video={},se._desiredVideoProperties.width&&(e.video.width=se._desiredVideoProperties.width),se._desiredVideoProperties.height&&(e.video.height=se._desiredVideoProperties.height),se._desiredVideoProperties.frameRate&&(e.video.frameRate={minFrameRate:se._desiredVideoProperties.frameRate,maxFrameRate:se._desiredVideoProperties.frameRate}),se._desiredVideoProperties.videoSrcId&&(e.video.deviceId=se._desiredVideoProperties.videoSrcId)):(e.video={},se._desiredVideoProperties.width&&(e.video.width={max:se._desiredVideoProperties.width,min:se._desiredVideoProperties.width,ideal:se._desiredVideoProperties.width}),se._desiredVideoProperties.height&&(e.video.height={max:se._desiredVideoProperties.height,min:se._desiredVideoProperties.height,ideal:se._desiredVideoProperties.height}),se._desiredVideoProperties.frameRate&&(e.video.frameRate={max:se._desiredVideoProperties.frameRate,ideal:se._desiredVideoProperties.frameRate}),se._desiredVideoProperties.videoSrcId&&(e.video.deviceId=se._desiredVideoProperties.videoSrcId),0===Object.keys(e.video).length&&(e.video=!0)):e.video=!1,se.audioEnabled?t&&t.browserDetails&&"firefox"===t.browserDetails.browser?(e.audio={},se._desiredAudioProperties.audioSrcId&&(e.audio.deviceId=se._desiredAudioProperties.audioSrcId)):(e.audio={mandatory:{},optional:[]},se._desiredAudioProperties.audioSrcId&&(e.audio.optional=e.audio.optional||[],e.audio.optional.push({deviceId:se._desiredAudioProperties.audioSrcId}))):e.audio=!1,e)},this.setApplicationName=function(e){se.applicationName=e},this.enableDebug=function(e){e?se.debugPrinter=function(e,t){var n=(new Date).toISOString(),r=(new Error).stack,i="location unknown";if(r){var o=r.split("\n");i="",o.length>=5&&(i=o[4])}console.log("debug "+n+" : "+e+" ["+i+"]"),"undefined"!=typeof t&&console.log("debug "+n+" : ",t)}:se.debugPrinter=null},this.supportsGetUserMedia=function(){return"undefined"!=typeof navigator.getUserMedia},this.supportsPeerConnections=function(){return"undefined"!=typeof RTCPeerConnection},this.supportsDataChannels=function(){var e=!1;if(se.supportsPeerConnections())try{var t=new RTCPeerConnection({iceServers:[]},{});e="undefined"!=typeof t.createDataChannel,t.close()}catch(e){}return e},this.supportsStatistics=function(){var e=!1;if(se.supportsPeerConnections())try{var t=new RTCPeerConnection({iceServers:[]},{});e="undefined"!=typeof t.getStats,t.close()}catch(e){}return e},this.createRTCPeerConnection=function(e,t){
if(se.supportsPeerConnections())return new RTCPeerConnection(e,t);throw"Your browser doesn't support webRTC (RTCPeerConnection)"},this.getDatachannelConstraints=function(){return{reliable:t&&t.browserDetails&&"chrome"!==t.browserDetails.browser&&t.browserDetails.version<31}},ge={audio:!1,video:!1};var Se=!1,Pe=null,xe=null,Te=null,_e=null,De={},Oe={msgTypes:{}},Ae=null,Le=function(){},Ie={},Ne={};this.acceptCheck=function(e,t){t(!0)},this.streamAcceptor=function(e,t){},this.onStreamClosed=function(e){},this.callCancelled=function(e){},this.getPeerConnectionByUserId=function(e){return Ie&&Ie[e]?Ie[e].pc:null};var Me=[{googTransmitBitrate:"transmitBitRate",googActualEncBitrate:"encodeRate",googAvailableSendBandwidth:"availableSendRate"},{googCodecName:"audioCodec",googTypingNoiseState:"typingNoise",packetsSent:"audioPacketsSent",bytesSent:"audioBytesSent"},{googCodecName:"videoCodec",googFrameRateSent:"outFrameRate",packetsSent:"videoPacketsSent",bytesSent:"videoBytesSent"},{packetsLost:"videoPacketsLost",packetsReceived:"videoPacketsReceived",bytesReceived:"videoBytesReceived",googFrameRateOutput:"frameRateOut"},{packetsLost:"audioPacketsLost",packetsReceived:"audioPacketsReceived",bytesReceived:"audioBytesReceived",audioOutputLevel:"audioOutputLevel"},{googRemoteAddress:"remoteAddress",googActiveConnection:"activeConnection"},{audioInputLevel:"audioInputLevel"}],Be={"outboundrtp_audio.bytesSent":"audioBytesSent","outboundrtp_video.bytesSent":"videoBytesSent","inboundrtp_video.bytesReceived":"videoBytesReceived","inboundrtp_audio.bytesReceived":"audioBytesReceived","outboundrtp_audio.packetsSent":"audioPacketsSent","outboundrtp_video.packetsSent":"videoPacketsSent","inboundrtp_video.packetsReceived":"videoPacketsReceived","inboundrtp_audio.packetsReceived":"audioPacketsReceived","inboundrtp_video.packetsLost":"videoPacketsLost","inboundrtp_audio.packetsLost":"audioPacketsLost",firefoxRemoteAddress:"remoteAddress"};t&&t.browserDetails&&"firefox"===t.browserDetails.browser?Be:Me;this.getPeerStatistics=function(e,n,r){t&&t.browserDetails&&"firefox"===t.browserDetails.browser?l(e,n,r):f(e,n,r)};var je=null;this.setRoomApiField=function(e,t,n){if(se._roomApiFields||(se._roomApiFields={}),!t&&!n)return void delete se._roomApiFields[e];if(se._roomApiFields[e]||(se._roomApiFields[e]={}),n!==r&&null!==n){if("object"===("undefined"==typeof n?"undefined":d(n)))try{JSON.stringify(n)}catch(e){return void se.showError(se.errCodes.DEVELOPER_ERR,"easyrtc.setRoomApiField passed bad object ")}se._roomApiFields[e][t]={fieldName:t,fieldValue:n}}else delete se._roomApiFields[e][t];se.webSocketConnected&&h(e)},this.showError=function(e,t){se.onError({errorCode:e,errorText:t})},this.onError=function(e){i("saw error "+e.errorText);var t,n=document.getElementById("easyrtcErrorDialog");if(!n){n=document.createElement("div"),n.id="easyrtcErrorDialog";var r=document.createElement("div");r.innerHTML="Error messages",r.className="easyrtcErrorDialog_title",n.appendChild(r),t=document.createElement("div"),t.id="easyrtcErrorDialog_body",n.appendChild(t);var o=document.createElement("button");o.appendChild(document.createTextNode("Okay")),o.className="easyrtcErrorDialog_okayButton",o.onclick=function(){t.innerHTML="",n.style.display="none"},n.appendChild(o),document.body.appendChild(n)}t=document.getElementById("easyrtcErrorDialog_body");var a=document.createElement("div");a.className="easyrtcErrorDialog_element",a.appendChild(document.createTextNode(e.errorText)),t.appendChild(a),n.style.display="block"},this.createObjectURL=function(e){var t;if(window.URL&&window.URL.createObjectURL)return window.URL.createObjectURL(e);if(window.webkitURL&&window.webkitURL.createObjectURL)return window.webkit.createObjectURL(e);throw t="Your browsers does not support URL.createObjectURL.",i("saw exception "+t),t},this.cleanId=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;"};return e.replace(/[&<>]/g,function(e){return t[e]})},se.setRoomEntryListener=function(e){se.roomEntryListener=e},se.setRoomOccupantListener=function(e){xe=e},this.setDataChannelOpenListener=function(e){Te=e},this.setDataChannelCloseListener=function(e){_e=e},this.getConnectionCount=function(){var e,t=0;for(e in Ie)Ie.hasOwnProperty(e)&&se.getConnectStatus(e)===se.IS_CONNECTED&&t++;return t},this.setMaxP2PMessageLength=function(e){this.maxP2PMessageLength=e},this.enableAudio=function(e){se.audioEnabled=e},this.enableVideo=function(e){se.videoEnabled=e},this.enableDataChannels=function(e){Se=e},this.getLocalMediaIds=function(){return Object.keys(ye)},this.register3rdPartyLocalMediaStream=function(e,t){return y(e,t)},this.getNameOfRemoteStream=function(e,t){return"string"==typeof t?w(e,t):t.id?w(e,t.id):void 0},this.closeLocalMediaStream=function(e){return b(e)},this.closeLocalStream=this.closeLocalMediaStream,this.enableCamera=function(e,t){var n=m(t);n&&n.getVideoTracks&&g(e,n.getVideoTracks())},this.enableMicrophone=function(e,t){var n=m(t);n&&n.getAudioTracks&&g(e,n.getAudioTracks())},this.muteVideoObject=function(e,t){var n;if("string"==typeof e){if(n=document.getElementById(e),!n)throw"Unknown video object "+e}else{if(!e)throw"muteVideoObject passed a null";n=e}n.muted=!!t},se.getLocalStreamAsUrl=function(e){var t=m(e);if(null===t)throw"Developer error: attempt to get a MediaStream without invoking easyrtc.initMediaSource successfully";return se.createObjectURL(t)},this.getLocalStream=function(e){return m(e)||null},this.clearMediaStream=function(e){"undefined"!=typeof e.src?e.src="":"undefined"!=typeof e.srcObject?e.srcObject="":"undefined"!=typeof e.mozSrcObject&&(e.mozSrcObject=null)},this.setVideoObjectSrc=function(e,t){t&&""!==t?(e.autoplay=!0,"undefined"!=typeof e.src?e.src=se.createObjectURL(t):"undefined"!=typeof e.srcObject?e.srcObject=t:"undefined"!=typeof e.mozSrcObject&&(e.mozSrcObject=se.createObjectURL(t)),e.play()):se.clearMediaStream(e)},this.buildLocalMediaStream=function(e,t,n){var r;if("string"!=typeof e)return se.showError(se.errCodes.DEVELOPER_ERR,"easyrtc.buildLocalMediaStream not supplied a stream name"),null;var i=null;for(var o in ye)if(ye.hasOwnProperty(o)&&(i=ye[o]))break;if(!i)for(o in Ie)if(Ie.hasOwnProperty(o)){var a=Ie[o].pc.getRemoteStreams();a&&a.length>0&&(i=a[0])}if(!i)return se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to create a mediastream without one to clone from"),null;var s=i.clone(),c=s.getTracks();if(t)for(r=0;r<t.length;r++)s.addTrack(t[r].clone());if(n)for(r=0;r<n.length;r++)s.addTrack(n[r].clone());for(r=0;r<c.length;r++)s.removeTrack(c[r]);return y(s,e),s},this.loadStylesheet=function(){var e,t,n=document.getElementsByTagName("link");for(e in n)if(n.hasOwnProperty(e)&&(t=n[e],t.href&&t.href.match(/\/easyrtc.css/)))return;var r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","/easyrtc/easyrtc.css");var i=document.getElementsByTagName("head")[0],o=i.childNodes[0];i.insertBefore(r,o)},this.formatError=function(e){var t,n;if(null===e||"undefined"==typeof e)return"null";if("string"==typeof e)return e;if(e.type&&e.description)return e.type+" : "+e.description;if("object"!==("undefined"==typeof e?"undefined":d(e)))return"Strange case";try{return JSON.stringify(e)}catch(r){n="{";for(t in e)e.hasOwnProperty(t)&&"string"==typeof e[t]&&(n=n+t+"='"+e[t]+"' ");return n+="}"}},this.initMediaSource=function(e,t,n){function r(){return(new Date).getTime()}function o(e){var t=r();if(t<u+1e3){i("Trying getUserMedia a second time");try{navigator.getUserMedia(a,s,c)}catch(t){c(e)}}else c(e)}if(i("about to request local media"),n||(n="default"),ge={audio:se.audioEnabled,video:se.videoEnabled},t||(t=function(e,t){var n="easyrtc.initMediaSource: "+se.formatError(t);i(n),se.showError(se.errCodes.MEDIA_ERR,n)}),!se.supportsGetUserMedia())return void t(se.errCodes.MEDIA_ERR,se.getConstantString("noWebrtcSupport"));if(!e)return void se.showError(se.errCodes.DEVELOPER_ERR,"easyrtc.initMediaSource not supplied a successCallback");var a=se.getUserMediaConstraints(),s=function(t){i("getUserMedia success callback entered"),i("successfully got local media"),t.streamName=n,y(t,n);var r,o,a,s;ge.video?(r=document.createElement("video"),r.muted=!0,o=30,a=function(){r.videoWidth>0||o<0?(se.nativeVideoWidth=r.videoWidth,se.nativeVideoHeight=r.videoHeight,!se._desiredVideoProperties.height||se.nativeVideoHeight===se._desiredVideoProperties.height&&se.nativeVideoWidth===se._desiredVideoProperties.width||se.showError(se.errCodes.MEDIA_WARNING,se.format(se.getConstantString("resolutionWarning"),se._desiredVideoProperties.width,se._desiredVideoProperties.height,se.nativeVideoWidth,se.nativeVideoHeight)),se.setVideoObjectSrc(r,null),r.removeNode?r.removeNode(!0):(s=document.createElement("div"),s.appendChild(r),s.removeChild(r)),Le(),e&&e(t)):(o-=1,setTimeout(a,300))},se.setVideoObjectSrc(r,t),a()):(Le(),e&&e(t))},c=function(e){i("getusermedia failed"),i("failed to get local media");var r;r="string"==typeof e?e:e.name?e.name:"Unknown",t&&(i("invoking error callback",r),t(se.errCodes.MEDIA_ERR,se.format(se.getConstantString("gumFailed"),r))),b(n),ge={audio:!1,video:!1},Le()};if(!se.audioEnabled&&!se.videoEnabled)return void c(se.getConstantString("requireAudioOrVideo"));var u;try{u=r(),navigator.getUserMedia(a,s,o)}catch(e){o(e)}},this.setAcceptChecker=function(e){se.acceptCheck=e},this.setStreamAcceptor=function(e){se.streamAcceptor=e},se.setOnError=function(e){se.onError=e},this.setCallCancelled=function(e){se.callCancelled=e},this.setOnStreamClosed=function(e){se.onStreamClosed=e},this.setPeerListener=function(e,t,n){t?(Oe.msgTypes[t]||(Oe.msgTypes[t]={sources:{}}),n?Oe.msgTypes[t].sources[n]={cb:e}:Oe.msgTypes[t].cb=e):Oe.cb=e},this.receivePeerDistribute=function(e,t,n){var r=t.msgType,o=t.msgData;if(!r)return void i("received peer message without msgType",t);if(Oe.msgTypes[r]){if(Oe.msgTypes[r].sources[e]&&Oe.msgTypes[r].sources[e].cb)return void Oe.msgTypes[r].sources[e].cb(e,r,o,n);if(Oe.msgTypes[r].cb)return void Oe.msgTypes[r].cb(e,r,o,n)}Oe.cb&&Oe.cb(e,r,o,n)},this.setServerListener=function(e){Ae=e},this.setSocketUrl=function(e,t){i("WebRTC signaling server URL set to "+e),Pe=e,t&&(he=t)},this.setUsername=function(e){return se.myEasyrtcid?(se.showError(se.errCodes.DEVELOPER_ERR,"easyrtc.setUsername called after authentication"),!1):se.isNameValid(e)?(se.username=e,!0):(se.showError(se.errCodes.BAD_NAME,se.format(se.getConstantString("badUserName"),e)),!1)},this.usernameToIds=function(e,t){var n,r,i=[];for(r in De)if(De.hasOwnProperty(r)&&(!t||r===t))for(n in De[r])De[r].hasOwnProperty(n)&&De[r][n].username===e&&i.push({easyrtcid:n,roomName:r});return i},this.getRoomApiField=function(e,t,n){return De[e]&&De[e][t]&&De[e][t].apiField&&De[e][t].apiField[n]?De[e][t].apiField[n].fieldValue:r},this.setCredential=function(e){try{return JSON.stringify(e),Re=e,!0}catch(e){throw se.showError(se.errCodes.BAD_CREDENTIAL,"easyrtc.setCredential passed a non-JSON-able object"),"easyrtc.setCredential passed a non-JSON-able object"}},this.setDisconnectListener=function(e){se.disconnectListener=e},this.idToName=function(e){var t;for(t in De)if(De.hasOwnProperty(t)&&De[t][e]&&De[t][e].username)return De[t][e].username;return e},this.webSocket=null;var Ue={},Ve=null,Fe=!1;this.setUseFreshIceEachPeerConnection=function(e){Fe=e},this.getServerIce=function(){return Ue},this.setIceUsedInCalls=function(e){e.iceServers?Ve=e:se.showError(se.errCodes.DEVELOPER_ERR,"Bad ice configuration passed to easyrtc.setIceUsedInCalls")},this.haveAudioTrack=function(e,t){return E(e,!0,t)},this.haveVideoTrack=function(e,t){return E(e,!1,t)},this.getRoomField=function(e,t){var n=se.getRoomFields(e);return n&&n[t]?n[t].fieldValue:r};var qe=null,ze=null,Je=null;this.disconnect=function(){i("attempt to disconnect from WebRTC signalling server"),se.disconnecting=!0,se.hangupAll(),se.loggingOut=!0,setTimeout(function(){if(se.webSocket){try{se.webSocket.disconnect()}catch(e){}Je=se.webSocket,se.webSocket=0}se.loggingOut=!1,se.disconnecting=!1,xe&&xe(null,{},!1),se.emitEvent("roomOccupant",{}),Ee={}},250)};var Ge=0;this.sendDataP2P=function(e,t,n){var r=JSON.stringify({msgType:t,msgData:n});if(i("sending p2p message to "+e+" with data="+JSON.stringify(r)),Ie[e])if(Ie[e].dataChannelS)if(Ie[e].dataChannelReady)try{r.length>se.maxP2PMessageLength?S(e,r):Ie[e].dataChannelS.send(r)}catch(e){throw i("sendDataP2P error: ",e),e}else se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to use data channel to "+e+" before it's ready to send.");else se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to send data peer to peer without establishing a data channel to "+e+" first.");else se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to send data peer to peer without a connection to "+e+" first.")},this.sendDataWS=function(e,t,n,r){i("sending client message via websockets to "+e+" with data="+JSON.stringify(n)),r||(r=function(e){"error"===e.msgType&&se.showError(e.msgData.errorCode,e.msgData.errorText)});var o={msgType:t,msgData:n};if(e&&("string"==typeof e?o.targetEasyrtcid=e:"object"===("undefined"==typeof e?"undefined":d(e))&&(e.targetEasyrtcid&&(o.targetEasyrtcid=e.targetEasyrtcid),e.targetRoom&&(o.targetRoom=e.targetRoom),e.targetGroup&&(o.targetGroup=e.targetGroup))),!se.webSocket)throw i("websocket failed because no connection to server"),"Attempt to send message without a valid connection to the server.";se.webSocket.json.emit("easyrtcMsg",o,r)},this.sendData=function(e,t,n,r){Ie[e]&&Ie[e].dataChannelReady?se.sendDataP2P(e,t,n):se.sendDataWS(e,t,n,r)},this.sendPeerMessage=function(e,t,n,r,o){function a(e){"error"===e.msgType?o&&o(e.msgData.errorCode,e.msgData.errorText):r&&r(e.msgType,e.msgData?e.msgData:null)}e||se.showError(se.errCodes.DEVELOPER_ERR,"destination was null in sendPeerMessage"),i("sending peer message "+JSON.stringify(n)),se.sendDataWS(e,t,n,a)},this.sendServerMessage=function(e,t,n,r){function o(e){"error"===e.msgType?r&&r(e.msgData.errorCode,e.msgData.errorText):n&&n(e.msgType,e.msgData?e.msgData:null)}var a={msgType:e,msgData:t};i("sending server message "+JSON.stringify(a)),se.sendDataWS(null,e,t,o)},this.getRoomList=function(e,t){R(null,"getRoomList",null,function(t,n){e(n.roomList)},function(e,n){t?t(e,n):se.showError(e,n)})},this.NOT_CONNECTED="not connected",this.BECOMING_CONNECTED="connection in progress to us.",this.IS_CONNECTED="is connected",this.getConnectStatus=function(e){if(!Ie.hasOwnProperty(e))return se.NOT_CONNECTED;var t=Ie[e];return!t.sharingAudio&&!t.sharingVideo||t.startedAV?t.sharingData&&!t.dataChannelReady?se.BECOMING_CONNECTED:se.IS_CONNECTED:se.BECOMING_CONNECTED},this.call=function(e,t,n,r,o){if(o)if("string"==typeof o)o=[o];else if("undefined"==typeof o.length)return void se.showError(se.errCodes.DEVELOPER_ERR,"easyrtc.call passed bad streamNames");if(i("initiating peer to peer call to "+e+" audio="+se.audioEnabled+" video="+se.videoEnabled+" data="+Se),!se.supportsPeerConnections())return void n(se.errCodes.CALL_ERR,se.getConstantString("noWebrtcSupport"));var a;if(!o&&ce){var s=se.getLocalStream();if(!s&&(se.audioEnabled||se.videoEnabled))return void se.initMediaSource(function(){se.call(e,t,n,r)},n)}if(!se.webSocket)throw a="Attempt to make a call prior to connecting to service",i(a),a;return ke[e]?(r(!0,e),F(e,ke[e],o),delete ke[e],void se.callCancelled(e,!1)):"undefined"!=typeof Ne[e]?(a="Call already pending acceptance",i(a),void n(se.errCodes.ALREADY_CONNECTED,a)):void(Fe?se.getFreshIceConfig(function(i){i?q(e,t,n,r,o):n(se.errCodes.CALL_ERR,"Attempt to get fresh ice configuration failed")}):q(e,t,n,r,o))};var He={};this.hangup=function(e){H(e),Le()},this.hangupAll=function(){var e=!1;for(var t in Ie)Ie.hasOwnProperty(t)&&(e=!0,H(t));e&&Le()},this.doesDataChannelWork=function(e){return!!Ie[e]&&!!Ie[e].dataChannelReady},this.getRemoteStream=function(e,t){if(Ie[e])return C(Ie[e],e,t);throw se.showError(se.errCodes.DEVELOPER_ERR,"attempt to get stream of uncalled party"),"Developer err: no such stream"},this.makeLocalStreamFromRemoteStream=function(e,t,n){var r;if(!Ie[e].pc)throw"Developer err: no such peer ";if(r=C(Ie[e],e,t),!r)throw"Developer err: no such stream";y(r,n)},this.addStreamToCall=function(e,t,n){t||(t="default");var r=m(t);if(r)if(Ie[e]&&Ie[e].pc){var o=Ie[e].pc;Ie[e].enableNegotiateListener=!0,o.addStream(r),n&&(Ie[e].streamsAddedAcks[t]=n)}else i("Can't add stream before a call has started.");else i("attempt to add nonexistent stream "+t)},this.setPeerListener(function(e,t,n){if(Ie[e]&&Ie[e].pc){var r=n.sdp,o=Ie[e].pc,a=function(t){var r=function(){function n(){i("sending answer succeeded")}function r(t,n){i("sending answer failed"),delete Ie[e],se.showError(t,n)}i("sending answer"),R(e,"answer",t,n,r),Ie[e].connectionAccepted=!0,x(e,n,r)};ue&&(t.sdp=ue(t.sdp)),o.setLocalDescription(t,r,function(e){se.showError(se.errCodes.INTERNAL_ERR,"setLocalDescription: "+n)})},s=function(){o.createAnswer(a,function(e){se.showError(se.errCodes.INTERNAL_ERR,"create-answer: "+e)},be),se.sendPeerMessage(e,"__gotAddedMediaStream",{sdp:r})};i("about to call setRemoteDescription in doAnswer");try{de&&(r.sdp=de(r.sdp)),o.setRemoteDescription(new RTCSessionDescription(r),s,function(e){se.showError(se.errCodes.INTERNAL_ERR,"set-remote-description: "+e)})}catch(e){i("saw exception in setRemoteDescription",e),se.showError(se.errCodes.INTERNAL_ERR,"setRemoteDescription failed: "+e.message)}}else se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to add additional stream before establishing the base call.")},"__addedMediaStream"),this.setPeerListener(function(e,t,n){if(Ie[e]&&Ie[e].pc){var r=n.sdp;de&&(r.sdp=de(r.sdp));var o=Ie[e].pc;o.setRemoteDescription(new RTCSessionDescription(r),function(){},function(e){se.showError(se.errCodes.INTERNAL_ERR,"set-remote-description: "+e)})}else i("setPeerListener failed: __gotAddedMediaStream Unknow easyrtcid "+e)},"__gotAddedMediaStream"),this.setPeerListener(function(e,t,n){if(Ie[e]&&Ie[e].pc){var r=C(Ie[e],e,n.streamName);r&&(_(e,r),a(r))}else i("setPeerListener failed: __closingMediaStream Unknow easyrtcid "+e)},"__closingMediaStream"),this.dumpPeerConnectionInfo=function(){var e;for(var t in Ie)if(Ie.hasOwnProperty(t)){var n=Ie[t].pc,r=n.getRemoteStreams(),o=[];for(e=0;e<r.length;e++)o.push(r[e].id);var a=n.getLocalStreams(),s=[];for(e=0;e<a.length;e++)s.push(a[e].id);i("For peer "+t),i("    "+JSON.stringify({local:s,remote:o}))}},this.isPeerInAnyRoom=function(e){return X(e)};var We={};this.updatePresence=function(e,t){se.presenceShow=e,se.presenceStatus=t,se.webSocketConnected&&R(null,"setPresence",{setPresence:{show:se.presenceShow,status:se.presenceStatus}},null)},this.getSessionFields=function(){return we},this.getSessionField=function(e){return we[e]?we[e].fieldValue:r},this.getRoomOccupantsAsArray=function(e){return De[e]?Object.keys(De[e]):null},this.getRoomOccupantsAsMap=function(e){return De[e]},this.isTurnServer=function(e){return!!se._turnServers[e]},this.isStunServer=function(e){return!!se._stunServers[e]},this.getFreshIceConfig=function(e){var t={msgType:"getIceConfig",msgData:{}};e||(e=function(){}),se.webSocket.json.emit("easyrtcCmd",t,function(t){"iceConfig"===t.msgType?(ee(t.msgData.iceConfig),e(!0)):(se.showError(t.msgData.errorCode,t.msgData.errorText),e(!1))})},this.joinRoom=function(e,t,n,r){if(se.roomJoin[e])return void se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to join room "+e+" which you are already in.");var i={roomName:e};if(t){try{JSON.stringify(t)}catch(e){throw se.showError(se.errCodes.DEVELOPER_ERR,"non-jsonable parameter to easyrtc.joinRoom"),"Developer error, see application error messages"}var o={};for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);i.roomParameter=o}var s,c,u,d={roomJoin:{}};se.webSocket?(d.roomJoin[e]=i,c=function(t,r){s=r.roomData,se.roomJoin[e]=i,n&&n(e),ne(s)},u=function(t,n){r?r(t,n,e):se.showError(t,se.format(se.getConstantString("unableToEnterRoom"),e,n))},R(null,"roomJoin",d,c,u)):se.roomJoin[e]=i},this.leaveRoom=function(e,t,n){var r;se.roomJoin[e]&&(se.webSocket?(r={},r[e]={roomName:e},R(null,"roomLeave",{roomLeave:r},function(n,r){var i=r.roomData;ne(i),t&&t(e)},function(t,r){n&&n(t,r,e)})):delete se.roomJoin[e])},this.getRoomsJoined=function(){var e,t={};for(e in se.roomJoin)se.roomJoin.hasOwnProperty(e)&&(t[e]=!0);return t},this.getRoomFields=function(e){return qe&&qe.rooms&&qe.rooms[e]?qe.rooms[e]:r},this.getApplicationFields=function(){return qe.application},this.getConnectionFields=function(){return qe.connection},this.useThisSocketConnection=function(e){ze=e},this.connect=function(e,t,r){return n||se.showError(se.errCodes.DEVELOPER_ERR,"Your HTML has not included the socket.io.js library"),!ze&&se.webSocket?void se.showError(se.errCodes.DEVELOPER_ERR,"Attempt to connect when already connected to socket server"):(Ue={},Je=null,Ee={},He={},se.applicationName=e,qe={rooms:{},application:{},connection:{}},i("attempt to connect to WebRTC signalling server with application name="+e),null===r&&(r=function(e,t){se.showError(e,t)}),void ae(t,r))}};return new i}),/*!
	  Script: easyrtc_app.js
	
	    Provides support file and data transfer support to easyrtc.
	
	  About: License
	
	    Copyright (c) 2016, Priologic Software Inc.
	    All rights reserved.
	
	    Redistribution and use in source and binary forms, with or without
	    modification, are permitted provided that the following conditions are met:
	
	        * Redistributions of source code must retain the above copyright notice,
	          this list of conditions and the following disclaimer.
	        * Redistributions in binary form must reproduce the above copyright
	          notice, this list of conditions and the following disclaimer in the
	          documentation and/or other materials provided with the distribution.
	
	    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
	    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
	    ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
	    LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
	    CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
	    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
	    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
	    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
	    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
	    POSSIBILITY OF SUCH DAMAGE.
	*/
function(n,i){o=[c],r=i,u="function"==typeof r?r.apply(t,o):r,!(void 0!==u&&(e.exports=u))}(void 0,function(e,t){"use strict";function n(n,i){function o(t,n){var r;if(t&&!document.getElementById(t))return e.showError(e.errCodes.DEVELOPER_ERR,"The monitor video id passed to easyApp was bad, saw "+t),!1;for(r in n)if(n.hasOwnProperty(r)){var i=n[r];if(!document.getElementById(i))return e.showError(e.errCodes.DEVELOPER_ERR,"The caller video id '"+i+"' passed to easyApp was bad."),!1}return!0}function a(e){return h[e.id]}function s(e,t){h[e.id]=t}function c(e){var n=a(e);return""===n||null===n||n===t}function u(e){return f[e]?document.getElementById(f[e]):null}function d(t,n){e.setVideoObjectSrc(t,n),t.style.visibility&&(t.style.visibility="visible")}function l(t){e.setVideoObjectSrc(t,""),t.style.visibility="hidden"}var f=i||[],p=i.length,h={},g=null,m=null;if(!o(n,f))throw"bad video element id";n&&(document.getElementById(n).muted="muted"),e.addEventListener("roomOccupants",function(t,n){var r;for(r=0;r<p;r++){var i=u(r);c(i)||e.isPeerInAnyRoom(a(i))||(m&&m(a(i),r),s(i,null))}}),e.setOnCall=function(e){g=e},e.setOnHangup=function(e){m=e},e.getIthCaller=function(e){if(e<0||e>=f.length)return null;var t=u(e);return a(t)},e.getSlotOfCaller=function(t){var n;for(n=0;n<p;n++)if(e.getIthCaller(n)===t)return n;return-1},e.setOnStreamClosed(function(e){var t;for(t=0;t<p;t++){var n=u(t);a(n)===e&&(l(n),s(n,""),m&&m(e,t))}}),e.setAcceptChecker(function(e,t){var n;for(n=0;n<p;n++){var r=u(n);if(c(r))return void t(!0)}t(!1)}),e.setStreamAcceptor(function(t,n){var r;e.debugPrinter&&e.debugPrinter("stream acceptor called");var i;for(r=0;r<p;r++)if(i=u(r),a(i)===t)return d(i,n),void(g&&g(t,r));for(r=0;r<p;r++)if(i=u(r),c(i))return s(i,t),g&&g(t,r),void d(i,n);i=u(0),i&&(e.hangup(a(i)),d(i,n),g&&g(t,0)),s(i,t)});var v,y,w,b;if(r)for(v=function(t){y=t.parentNode,s(t,""),w=document.createElement("div"),w.className="easyrtc_closeButton",w.onclick=function(){a(t)&&(e.hangup(a(t)),l(t),s(t,""))},y.appendChild(w)},b=0;b<p;b++)v(u(b));var C=null;if(e.videoEnabled&&null!==n){if(C=document.getElementById(n),!C)return void console.error("Programmer error: no object called "+n);C.muted="muted",C.defaultMuted=!0}}var r=!0;return e.dontAddCloseButtons=function(){r=!1},e.easyApp=function(t,r,i,o,a){function s(){d&&d(!0,""),o(e.myEasyrtcid)}function c(){function n(t,n){d?d(!1,n):a?a(e.errCodes.CONNECT_ERR,n):e.showError(e.errCodes.CONNECT_ERR,n)}u&&u(!0,null),null!==r&&e.setVideoObjectSrc(document.getElementById(r),e.getLocalStream()),e.connect(t,s,n)}var u=null,d=null;n(r,i),e.setGotMedia=function(e){u=e},e.setPeerClosedListener(function(t){setTimeout(function(){e.getSlotOfCaller(t)>=0&&e.isPeerInAnyRoom(t)&&e.call(t,function(){},function(){},function(){})},1e3)}),e.setGotConnection=function(e){d=e};var l=e.getLocalStream(null);l?c():e.initMediaSource(c,function(t,n){u?u(!1,n):a?a(e.errCodes.MEDIA_ERR,n):e.showError(e.errCodes.MEDIA_ERR,n)},null)},e})},function(e,t){"use strict";var n={Club:"草花",Diamond:"方块",Heart:"红心",Spade:"黑桃"};e.exports=function(e){if(!e)return null;var t=fairygui.UIPackage.getItemURL("Package1",n[e.suit]+(14==e.sort?1:e.sort));return t||console.log(n[e.suit]+(14==e.sort?1:e.sort),"not found"),t}},function(e,t){function n(e,t){return{type:"Feature",properties:t||{},geometry:e}}e.exports.feature=n,e.exports.point=function(e,t){if(!Array.isArray(e))throw new Error("Coordinates must be an array");if(e.length<2)throw new Error("Coordinates must be at least 2 numbers long");return n({type:"Point",coordinates:e.slice()},t)},e.exports.polygon=function(e,t){if(!e)throw new Error("No coordinates passed");for(var r=0;r<e.length;r++){var i=e[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t)},e.exports.lineString=function(e,t){if(!e)throw new Error("No coordinates passed");return n({type:"LineString",coordinates:e},t)},e.exports.featureCollection=function(e){return{type:"FeatureCollection",features:e}},e.exports.multiLineString=function(e,t){if(!e)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:e},t)},e.exports.multiPoint=function(e,t){if(!e)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:e},t)},e.exports.multiPolygon=function(e,t){if(!e)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:e},t)},e.exports.geometryCollection=function(e,t){return n({type:"GeometryCollection",geometries:e},t)};var r={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,kilometers:6373,kilometres:6373};e.exports.radiansToDistance=function(e,t){var n=r[t||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return e*n},e.exports.distanceToRadians=function(e,t){var n=r[t||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return e/n},e.exports.distanceToDegrees=function(e,t){var n=r[t||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return e/n*57.2958}},function(e,t,n){"use strict";function r(e,t,n,c){if("boolean"==typeof n&&(c=n,n={}),e<1)return new Error("Number must be >= 1");if("Feature"!==t.type)return new Error("Polygon parameter must be a Feature<(Polygon|MultiPolygon)>");if(this instanceof r)return new r(e,t,n);n=n||{},c=c||!1;for(var u=[],d=i(t),l=Math.round(parseFloat(e)),f=0;f<=l;f++){if(f===l)return c?o(u):u;var p=s("point",1,{bbox:d});a(p.features[0],t)===!1&&(f=--f),a(p.features[0],t)===!0&&(p.features[0].properties=n,u.push(p.features[0]))}}var i=n(213),o=n(215),a=n(216),s=n(217);e.exports=r},function(e,t,n){var r=n(214).coordEach;e.exports=function(e){var t=[1/0,1/0,-(1/0),-(1/0)];return r(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}},function(e,t){function n(e,t,n){var r,i,o,a,s,c,u,d,f,p=0,h="FeatureCollection"===e.type,g="Feature"===e.type,m=h?e.features.length:1;for(r=0;r<m;r++)for(d=h?e.features[r].geometry:g?e.geometry:e,f="GeometryCollection"===d.type,c=f?d.geometries.length:1,a=0;a<c;a++)if(s=f?d.geometries[a]:d,u=s.coordinates,p=!n||"Polygon"!==s.type&&"MultiPolygon"!==s.type?0:1,"Point"===s.type)t(u);else if("LineString"===s.type||"MultiPoint"===s.type)for(i=0;i<u.length;i++)t(u[i]);else if("Polygon"===s.type||"MultiLineString"===s.type)for(i=0;i<u.length;i++)for(o=0;o<u[i].length-p;o++)t(u[i][o]);else{if("MultiPolygon"!==s.type)throw new Error("Unknown Geometry Type");for(i=0;i<u.length;i++)for(o=0;o<u[i].length;o++)for(l=0;l<u[i][o].length-p;l++)t(u[i][o][l])}}function r(e,t,r,i){return n(e,function(e){r=t(r,e)},i),r}function i(e,t){var n;switch(e.type){case"FeatureCollection":for(features=e.features,n=0;n<e.features.length;n++)t(e.features[n].properties);break;case"Feature":t(e.properties)}}function o(e,t,n){return i(e,function(e){n=t(n,e)}),n}e.exports.coordEach=n,e.exports.coordReduce=r,e.exports.propEach=i,e.exports.propReduce=o},function(e,t){e.exports=function(e){return{type:"FeatureCollection",features:e}}},function(e,t){function n(e,t){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r][0],a=t[r][1],s=t[i][0],c=t[i][1],u=a>e[1]!=c>e[1]&&e[0]<(s-o)*(e[1]-a)/(c-a)+o;u&&(n=!n)}return n}e.exports=function(e,t){var r=t.geometry.coordinates,i=[e.geometry.coordinates[0],e.geometry.coordinates[1]];"Polygon"===t.geometry.type&&(r=[r]);for(var o=!1,a=0;a<r.length&&!o;){if(n(i,r[a][0])){for(var s=!1,c=1;c<r[a].length&&!s;)n(i,r[a][c])&&(s=!0),c++;s||(o=!0)}a++}return o}},function(e,t,n){var r=n(218);e.exports=function(e,t,n){switch(n=n||{},t=t||1,e){case"point":case"points":case void 0:return r.point(t,n.bbox);case"polygon":case"polygons":return r.polygon(t,n.num_vertices,n.max_radial_length,n.bbox);default:throw new Error("Unknown type given: valid options are points and polygons")}}},function(e,t){function n(e){return e?u(e):[a(),s()]}function r(e){return function(t,n){return[t[0]+e[0],t[1]+e[1]]}}function o(){return Math.random()-.5}function a(){return 360*o()}function s(){return 180*o()}function c(e){return{type:"Point",coordinates:e||[a(),s()]}}function u(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}function d(e){return{type:"Polygon",coordinates:e}}function l(e){return{type:"Feature",geometry:e,properties:{}}}function f(e){return{type:"FeatureCollection",features:e}}e.exports=function(){throw new Error("call .point() or .polygon() instead")},e.exports.position=n,e.exports.point=function(e,t){var r=[];for(i=0;i<e;i++)r.push(l(t?c(n(t)):c()));return f(r)},e.exports.polygon=function(e,t,o,a){function s(e,t,n){n[t]=t>0?e+n[t-1]:e}function c(e,t){e=2*e*Math.PI/h[h.length-1];var n=Math.random();p.push([n*o*Math.sin(e),n*o*Math.cos(e)])}"number"!=typeof t&&(t=10),"number"!=typeof o&&(o=10);var u=[];for(i=0;i<e;i++){var p=[],h=Array.apply(null,new Array(t+1)).map(Math.random);h.forEach(s),h.forEach(c),p[p.length-1]=p[0],p=p.map(r(n(a))),u.push(l(d([p])))}return f(u)}},function(e,t,n){function r(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function i(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}var o=n(220);e.exports=o(r),e.exports.strict=o(i),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})})},function(e,t){function n(e,t){function r(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var r=e.apply(this,t),i=t[t.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach(function(e){r[e]=i[e]}),r}if(e&&t)return n(e)(t);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(t){r[t]=e[t]}),r}e.exports=n},function(e,t,n){e.exports=n.p+"pleasebet.mp3?414cc71ec543e8921a3bcc630db8b3b4"},function(e,t,n){e.exports=n.p+"clock.mp3?c1aced506c948d03533e355365409d60"},function(e,t,n){function r(e){return n(i(e))}function i(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./play0.mp3":224,"./play1.mp3":225,"./play2.mp3":226,"./play3.mp3":227,"./play4.mp3":228,"./play5.mp3":229,"./play6.mp3":230,"./play7.mp3":231,"./play8.mp3":232,"./play9.mp3":233,"./playmore.mp3":234,"./playpair.mp3":235,"./playwin.mp3":236};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=223},function(e,t,n){e.exports=n.p+"play0.mp3?d332e9c6f843daf1fddd8cbc8a224151"},function(e,t,n){e.exports=n.p+"play1.mp3?d9dff667fd704a9b35dade20c7312b8a"},function(e,t,n){e.exports=n.p+"play2.mp3?c2042e68708ae6c1aab08f42c69a3459"},function(e,t,n){e.exports=n.p+"play3.mp3?2d6eefdc8b11b6850bc052d6d058e2de"},function(e,t,n){e.exports=n.p+"play4.mp3?64a8b8af2934104fc26d76edcd346ea8"},function(e,t,n){e.exports=n.p+"play5.mp3?379ad6c3562bf69aa39312eb2b0b8d5f"},function(e,t,n){e.exports=n.p+"play6.mp3?8dc6386a2c2b1968f42a1d85e0b1780d"},function(e,t,n){e.exports=n.p+"play7.mp3?eb987306786f8690211755dfd14786b4"},function(e,t,n){e.exports=n.p+"play8.mp3?b580646218bb255295cca71d56cdbec9"},function(e,t,n){e.exports=n.p+"play9.mp3?b3aa83c10f7ff836c80b3587f0914dcc"},function(e,t,n){e.exports=n.p+"playmore.mp3?ea688e8bab7cb8e8d8cd3e4154e0beb7"},function(e,t,n){e.exports=n.p+"playpair.mp3?6f8c7c0feeb2f82050cfe37267888006"},function(e,t,n){e.exports=n.p+"playwin.mp3?4854851a8b397ba9b21d87ef54e83394"},function(e,t,n){function r(e){return n(i(e))}function i(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./bank0.mp3":238,"./bank1.mp3":239,"./bank2.mp3":240,"./bank3.mp3":241,"./bank4.mp3":242,"./bank5.mp3":243,"./bank6.mp3":244,"./bank7.mp3":245,"./bank8.mp3":246,"./bank9.mp3":247,"./bankmore.mp3":248,"./bankpair.mp3":249,"./bankwin.mp3":250};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=237},function(e,t,n){e.exports=n.p+"bank0.mp3?dc9400d5a15610cbf7677383eb91a426"},function(e,t,n){e.exports=n.p+"bank1.mp3?7ba76cdc0e7344b87ed95e6078c4d2ea"},function(e,t,n){e.exports=n.p+"bank2.mp3?75bc568ee7984afa6311972b2fab3209"},function(e,t,n){e.exports=n.p+"bank3.mp3?7e7ccb84de775b2878d8cf6038b33449"},function(e,t,n){e.exports=n.p+"bank4.mp3?4a4901b670ae3b2accbd2bcd5e021b41"},function(e,t,n){e.exports=n.p+"bank5.mp3?fab7e9cd680e6014cb8d77b310171ef9"},function(e,t,n){e.exports=n.p+"bank6.mp3?e407636b3c4b460b17ec73043dec1789"},function(e,t,n){e.exports=n.p+"bank7.mp3?90f846fa86e2b28c1aaaa3cca1aabef5"},function(e,t,n){e.exports=n.p+"bank8.mp3?5fa0854af8e65ff5201f54c885f697a6"},function(e,t,n){e.exports=n.p+"bank9.mp3?c3d81e524020df727392706de66ad5e1"},function(e,t,n){e.exports=n.p+"bankmore.mp3?97244721ce2e68324295136daa7ad67d"},function(e,t,n){e.exports=n.p+"bankpair.mp3?1b7dc053f2666e3ca790f987877bb621"},function(e,t,n){e.exports=n.p+"bankwin.mp3?4ef1735723c6abfdd249f4c7793b60de"},function(e,t,n){e.exports=n.p+"deal.mp3?0e98b6ad29bce0d9db74758644240512"},function(e,t,n){e.exports=n.p+"tie.mp3?498dc41dcd1847af774710878480c743"},function(e,t,n){e.exports=n.p+"chipMoveMuch.mp3?c662c6d29dfc55c241dbf891fee76c25"},function(e,t,n){e.exports=n.p+"chipMoveOne.mp3?53e398a6f57e0a3df8cfc45760ab5a58"},function(e,t,n){e.exports=n.p+"chipBack.mp3?3a15a698d05413607f0035ff0ef8df48"},function(e,t,n){e.exports=n.p+"ingameBGMMono.mp3?e2f1dae4237ad6d5be9aacbcd2975699"}]));